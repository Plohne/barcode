{"mappings":"C,A,W,S,E,C,C,C,C,C,C,C,E,O,c,C,E,E,C,I,E,I,E,W,C,E,a,C,C,E,C,ISAe,EiByCX,E,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,C,E,E,C,E,E,E,iB,A,O,I,A,C,E,S,C,E,G,K,E,O,C,C,E,C,O,C,G,K,E,C,I,E,C,C,E,A,Q,C,C,E,C,I,E,C,G,E,Q,C,C,E,O,C,C,E,C,E,E,I,C,E,O,C,E,E,O,E,E,O,A,C,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,Q,C,S,C,C,C,E,C,C,E,C,C,E,E,iB,C,G,I,E,E,Q,CjBzCW,SAAAwY,EAAsCC,CAAAA,CAAUC,CAAAA,CAAYR,CAAAA,EACzE,GAAA,CAAKQ,EAAWxW,GAAAA,CAAIuW,GAClB,MAAM,AAAItW,UAAU,gBAAkB+V,EAAS,kCAEjD,OAAOQ,EAAWnY,GAAAA,CAAIkY,EACxB,CEFe,SAAAI,EAA+BJ,CAAAA,CAAUC,CAAAA,MDHGE,ECKzD,MDJIA,CADqDA,ECIxCJ,EAA4BC,EAAUC,EAAY,QDHpDnY,GAAAA,CACNqY,EAAWrY,GAAAA,CAAIkB,IAAAA,CCGOgX,GDDxBG,EAAWvW,KACpB,ACCA,CCNe,SAAAyW,EAAoCC,CAAAA,CAAKC,CAAAA,EACtD,GAAIA,EAAkB9W,GAAAA,CAAI6W,GACxB,MAAM,AAAI5W,UAAU,iEAExB,CCFe,SAAA8W,EAAgCF,CAAAA,CAAKL,CAAAA,CAAYrW,CAAAA,EAC9DyW,EAA2BC,EAAKL,GAChCA,EAAWlY,GAAAA,CAAIuY,EAAK1W,EACtB,CEFe,SAAA8W,EAA+BV,CAAAA,CAAUC,CAAAA,CAAYrW,CAAAA,EAGlE,OADA6W,ADLa,SAAkCT,CAAAA,CAAUG,CAAAA,CAAYvW,CAAAA,EACrE,GAAIuW,EAAWpY,GAAAA,CACboY,EAAWpY,GAAAA,CAAIiB,IAAAA,CAAKgX,EAAUpW,OACzB,CACL,GAAA,CAAKuW,EAAWlW,QAAAA,CAId,MAAM,AAAIP,UAAU,2CAEtByW,CAAAA,EAAWvW,KAAAA,CAAQA,CACrB,CACF,ECP0BoW,EADPD,EAA4BC,EAAUC,EAAY,OACrB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","sources":["<anon>","node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/@parcel/runtime-js/lib/runtime-15fac6ee379d80f9.js","node_modules/@parcel/runtime-js/lib/helpers/browser/js-loader.js","node_modules/@parcel/runtime-js/lib/helpers/cacheLoader.js","node_modules/@parcel/runtime-js/lib/runtime-bf5d8cd6ecf3c3c2.js","src/js/scanner.js","node_modules/@georapbox/resize-observer-element/dist/resize-observer-defined.js","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_extract_field_descriptor.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_apply_descriptor_get.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_private_field_get.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_check_private_redeclaration.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_private_field_init.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_apply_descriptor_set.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_private_field_set.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_private_method_get.mjs","node_modules/@georapbox/resize-observer-element/dist/node_modules/@swc/helpers/src/_class_private_method_init.mjs","node_modules/@georapbox/resize-observer-element/dist/src/resize-observer.js","node_modules/@georapbox/resize-observer-element/dist/src/resize-observer-defined.js","node_modules/@georapbox/capture-photo-element/dist/capture-photo-defined.js","node_modules/@georapbox/capture-photo-element/dist/<anon>","node_modules/@georapbox/capture-photo-element/dist/src/capture-photo-defined.js","node_modules/@georapbox/capture-photo-element/dist/src/capture-photo.js","node_modules/@georapbox/capture-photo-element/dist/src/utils/clamp.js","src/js/services/storage.js","node_modules/idb-keyval/dist/compat.js","src/js/services/product-service.js"],"sourcesContent":["(function () {\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global =\n        typeof globalThis !== 'undefined'\n          ? globalThis\n          : typeof self !== 'undefined'\n          ? self\n          : typeof window !== 'undefined'\n          ? window\n          : typeof global !== 'undefined'\n          ? global\n          : {};\n  \nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequirea202\"];\n\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequirea202\"] = parcelRequire;\n}\n\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"iE7OH\", function(module, exports) {\n\n$parcel$export(module.exports, \"register\", function () { return $0380ce8f1f064ccc$export$6503ec6e8aabbaf; }, function (v) { return $0380ce8f1f064ccc$export$6503ec6e8aabbaf = v; });\n$parcel$export(module.exports, \"resolve\", function () { return $0380ce8f1f064ccc$export$f7ad0328861e2f03; }, function (v) { return $0380ce8f1f064ccc$export$f7ad0328861e2f03 = v; });\nvar $0380ce8f1f064ccc$export$6503ec6e8aabbaf;\nvar $0380ce8f1f064ccc$export$f7ad0328861e2f03;\n\"use strict\";\nvar $0380ce8f1f064ccc$var$mapping = new Map();\nfunction $0380ce8f1f064ccc$var$register(baseUrl, manifest) {\n    for(var i = 0; i < manifest.length - 1; i += 2)$0380ce8f1f064ccc$var$mapping.set(manifest[i], {\n        baseUrl: baseUrl,\n        path: manifest[i + 1]\n    });\n}\nfunction $0380ce8f1f064ccc$var$resolve(id) {\n    var resolved = $0380ce8f1f064ccc$var$mapping.get(id);\n    if (resolved == null) throw new Error(\"Could not resolve bundle with id \" + id);\n    return new URL(resolved.path, resolved.baseUrl).toString();\n}\n$0380ce8f1f064ccc$export$6503ec6e8aabbaf = $0380ce8f1f064ccc$var$register;\n$0380ce8f1f064ccc$export$f7ad0328861e2f03 = $0380ce8f1f064ccc$var$resolve;\n\n});\n\nparcelRegister(\"aNJCr\", function(module, exports) {\n\n$parcel$export(module.exports, \"getBundleURL\", function () { return $7dd1ddf6834435ca$export$bdfd709ae4826697; }, function (v) { return $7dd1ddf6834435ca$export$bdfd709ae4826697 = v; });\nvar $7dd1ddf6834435ca$export$bdfd709ae4826697;\nvar $7dd1ddf6834435ca$export$c9e73fbda7da57b6;\nvar $7dd1ddf6834435ca$export$5a759dc7a1cfb72a;\n\"use strict\";\nvar $7dd1ddf6834435ca$var$bundleURL = {};\nfunction $7dd1ddf6834435ca$var$getBundleURLCached(id) {\n    var value = $7dd1ddf6834435ca$var$bundleURL[id];\n    if (!value) {\n        value = $7dd1ddf6834435ca$var$getBundleURL();\n        $7dd1ddf6834435ca$var$bundleURL[id] = value;\n    }\n    return value;\n}\nfunction $7dd1ddf6834435ca$var$getBundleURL() {\n    try {\n        throw new Error();\n    } catch (err) {\n        var matches = (\"\" + err.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^)\\n]+/g);\n        if (matches) // The first two stack frames will be this function and getBundleURLCached.\n        // Use the 3rd one, which will be a runtime in the original bundle.\n        return $7dd1ddf6834435ca$var$getBaseURL(matches[2]);\n    }\n    return \"/\";\n}\nfunction $7dd1ddf6834435ca$var$getBaseURL(url) {\n    return (\"\" + url).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/.+)\\/[^/]+$/, \"$1\") + \"/\";\n}\n// TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\nfunction $7dd1ddf6834435ca$var$getOrigin(url) {\n    var matches = (\"\" + url).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^/]+/);\n    if (!matches) throw new Error(\"Origin not found\");\n    return matches[0];\n}\n$7dd1ddf6834435ca$export$bdfd709ae4826697 = $7dd1ddf6834435ca$var$getBundleURLCached;\n$7dd1ddf6834435ca$export$c9e73fbda7da57b6 = $7dd1ddf6834435ca$var$getBaseURL;\n$7dd1ddf6834435ca$export$5a759dc7a1cfb72a = $7dd1ddf6834435ca$var$getOrigin;\n\n});\n\nparcelRegister(\"3c8ZQ\", function(module, exports) {\n\n\nmodule.exports = (parcelRequire(\"4WKyX\"))((parcelRequire(\"iE7OH\")).resolve(\"Oreqb\")).then(()=>parcelRequire(\"dZsGG\"));\n\n});\nparcelRegister(\"4WKyX\", function(module, exports) {\n\"use strict\";\n\nvar $2prpb = parcelRequire(\"2prpb\");\nmodule.exports = $2prpb(function(bundle) {\n    return new Promise(function(resolve, reject) {\n        // Don't insert the same script twice (e.g. if it was already in the HTML)\n        var existingScripts = document.getElementsByTagName(\"script\");\n        if ([].concat(existingScripts).some(function isCurrentBundle(script) {\n            return script.src === bundle;\n        })) {\n            resolve();\n            return;\n        }\n        var preloadLink = document.createElement(\"link\");\n        preloadLink.href = bundle;\n        preloadLink.rel = \"preload\";\n        preloadLink.as = \"script\";\n        document.head.appendChild(preloadLink);\n        var script = document.createElement(\"script\");\n        script.async = true;\n        script.type = \"text/javascript\";\n        script.src = bundle;\n        script.onerror = function(e) {\n            var error = new TypeError(\"Failed to fetch dynamically imported module: \".concat(bundle, \". Error: \").concat(e.message));\n            script.onerror = script.onload = null;\n            script.remove();\n            reject(error);\n        };\n        script.onload = function() {\n            script.onerror = script.onload = null;\n            resolve();\n        };\n        document.getElementsByTagName(\"head\")[0].appendChild(script);\n    });\n});\n\n});\nparcelRegister(\"2prpb\", function(module, exports) {\n\"use strict\";\nvar $1c132cac09cd18d9$var$cachedBundles = {};\nvar $1c132cac09cd18d9$var$cachedPreloads = {};\nvar $1c132cac09cd18d9$var$cachedPrefetches = {};\nfunction $1c132cac09cd18d9$var$getCache(type) {\n    switch(type){\n        case \"preload\":\n            return $1c132cac09cd18d9$var$cachedPreloads;\n        case \"prefetch\":\n            return $1c132cac09cd18d9$var$cachedPrefetches;\n        default:\n            return $1c132cac09cd18d9$var$cachedBundles;\n    }\n}\nmodule.exports = function(loader, type) {\n    return function(bundle) {\n        var cache = $1c132cac09cd18d9$var$getCache(type);\n        if (cache[bundle]) return cache[bundle];\n        return cache[bundle] = loader.apply(null, arguments).catch(function(e) {\n            delete cache[bundle];\n            throw e;\n        });\n    };\n};\n\n});\n\n\n\nvar $7106f406bba1a55f$exports = {};\n\n\n(parcelRequire(\"iE7OH\")).register((parcelRequire(\"aNJCr\")).getBundleURL(\"hHmRL\"), JSON.parse('[\"hHmRL\",\"scanner.b2c49530.js\",\"Oreqb\",\"es.c8e8eed2.js\",\"7PPU8\",\"index.12cd6b58.js\"]'));\n\n// src/js/scanner.js - Simplified scanner for fridge app\nvar $81b28a4cd686838b$var$e, $81b28a4cd686838b$var$t, $81b28a4cd686838b$var$i, $81b28a4cd686838b$var$s;\nfunction $81b28a4cd686838b$var$n(e, t, i) {\n    if (!t.has(e)) throw new TypeError(\"attempted to \" + i + \" private field on non-instance\");\n    return t.get(e);\n}\nfunction $81b28a4cd686838b$var$a(e, t) {\n    return t.get ? t.get.call(e) : t.value;\n}\nfunction $81b28a4cd686838b$var$o(e, t) {\n    return $81b28a4cd686838b$var$a(e, $81b28a4cd686838b$var$n(e, t, \"get\"));\n}\nfunction $81b28a4cd686838b$var$r(e, t) {\n    if (t.has(e)) throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n}\nfunction $81b28a4cd686838b$var$l(e, t, i) {\n    $81b28a4cd686838b$var$r(e, t), t.set(e, i);\n}\nfunction $81b28a4cd686838b$var$h(e, t, i) {\n    if (t.set) t.set.call(e, i);\n    else {\n        if (!t.writable) throw new TypeError(\"attempted to set read only private field\");\n        t.value = i;\n    }\n}\nfunction $81b28a4cd686838b$var$d(e, t, i) {\n    return $81b28a4cd686838b$var$h(e, $81b28a4cd686838b$var$n(e, t, \"set\"), i), i;\n}\nfunction $81b28a4cd686838b$var$c(e, t, i) {\n    if (!t.has(e)) throw new TypeError(\"attempted to get private field on non-instance\");\n    return i;\n}\nfunction $81b28a4cd686838b$var$u(e, t) {\n    $81b28a4cd686838b$var$r(e, t), t.add(e);\n}\n$81b28a4cd686838b$var$e = {}, $81b28a4cd686838b$var$t = \"ResizeObserverElement\", $81b28a4cd686838b$var$i = function() {\n    return $81b28a4cd686838b$export$f0e45424cc896229;\n}, Object.defineProperty($81b28a4cd686838b$var$e, $81b28a4cd686838b$var$t, {\n    get: $81b28a4cd686838b$var$i,\n    set: $81b28a4cd686838b$var$s,\n    enumerable: !0,\n    configurable: !0\n});\nconst $81b28a4cd686838b$var$b = document.createElement(\"template\"), $81b28a4cd686838b$var$w = String.raw;\n$81b28a4cd686838b$var$b.innerHTML = $81b28a4cd686838b$var$w`\n  <style>:host { display: contents; }</style>\n  <slot></slot>\n`;\nvar $81b28a4cd686838b$var$f = new WeakMap, $81b28a4cd686838b$var$p = new WeakMap, $81b28a4cd686838b$var$v = new WeakMap, $81b28a4cd686838b$var$m = new WeakSet, $81b28a4cd686838b$var$E = new WeakSet, $81b28a4cd686838b$var$g = new WeakMap, $81b28a4cd686838b$var$y = new WeakSet;\nclass $81b28a4cd686838b$export$f0e45424cc896229 extends HTMLElement {\n    static get observedAttributes() {\n        return [\n            \"disabled\"\n        ];\n    }\n    attributeChangedCallback(e, t, i) {\n        \"disabled\" === e && t !== i && (this.disabled ? $81b28a4cd686838b$var$c(this, $81b28a4cd686838b$var$E, $81b28a4cd686838b$var$z).call(this) : $81b28a4cd686838b$var$c(this, $81b28a4cd686838b$var$m, $81b28a4cd686838b$var$C).call(this));\n    }\n    connectedCallback() {\n        $81b28a4cd686838b$var$c(this, $81b28a4cd686838b$var$y, $81b28a4cd686838b$var$O).call(this, \"disabled\"), \"ResizeObserver\" in window && ($81b28a4cd686838b$var$d(this, $81b28a4cd686838b$var$p, new ResizeObserver((e)=>{\n            this.dispatchEvent(new CustomEvent(\"resize-observer:resize\", {\n                bubbles: !0,\n                composed: !0,\n                detail: {\n                    entries: e\n                }\n            }));\n        })), this.disabled || $81b28a4cd686838b$var$c(this, $81b28a4cd686838b$var$m, $81b28a4cd686838b$var$C).call(this), $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$f).addEventListener(\"slotchange\", $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$g)));\n    }\n    disconnectedCallback() {\n        $81b28a4cd686838b$var$c(this, $81b28a4cd686838b$var$E, $81b28a4cd686838b$var$z).call(this), $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$f).removeEventListener(\"slotchange\", $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$g));\n    }\n    get disabled() {\n        return this.hasAttribute(\"disabled\");\n    }\n    set disabled(e) {\n        e ? this.setAttribute(\"disabled\", \"\") : this.removeAttribute(\"disabled\");\n    }\n    static defineCustomElement(e = \"resize-observer\") {\n        \"undefined\" == typeof window || window.customElements.get(e) || window.customElements.define(e, $81b28a4cd686838b$export$f0e45424cc896229);\n    }\n    constructor(){\n        super(), $81b28a4cd686838b$var$u(this, $81b28a4cd686838b$var$m), $81b28a4cd686838b$var$u(this, $81b28a4cd686838b$var$E), $81b28a4cd686838b$var$u(this, $81b28a4cd686838b$var$y), $81b28a4cd686838b$var$l(this, $81b28a4cd686838b$var$f, {\n            writable: !0,\n            value: void 0\n        }), $81b28a4cd686838b$var$l(this, $81b28a4cd686838b$var$p, {\n            writable: !0,\n            value: void 0\n        }), $81b28a4cd686838b$var$l(this, $81b28a4cd686838b$var$v, {\n            writable: !0,\n            value: void 0\n        }), $81b28a4cd686838b$var$l(this, $81b28a4cd686838b$var$g, {\n            writable: !0,\n            value: ()=>{\n                this.disabled || $81b28a4cd686838b$var$c(this, $81b28a4cd686838b$var$m, $81b28a4cd686838b$var$C).call(this);\n            }\n        }), this.shadowRoot || (this.attachShadow({\n            mode: \"open\"\n        }), this.shadowRoot.appendChild($81b28a4cd686838b$var$b.content.cloneNode(!0))), $81b28a4cd686838b$var$d(this, $81b28a4cd686838b$var$f, this.shadowRoot.querySelector(\"slot\")), $81b28a4cd686838b$var$d(this, $81b28a4cd686838b$var$p, null), $81b28a4cd686838b$var$d(this, $81b28a4cd686838b$var$v, []);\n    }\n}\nfunction $81b28a4cd686838b$var$C() {\n    $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$f) && $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$p) && ($81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$v).forEach((e)=>$81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$p).unobserve(e)), $81b28a4cd686838b$var$d(this, $81b28a4cd686838b$var$v, []), $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$f).assignedElements().forEach((e)=>{\n        $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$p).observe(e), $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$v).push(e);\n    }));\n}\nfunction $81b28a4cd686838b$var$z() {\n    $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$p) && $81b28a4cd686838b$var$o(this, $81b28a4cd686838b$var$p).disconnect();\n}\nfunction $81b28a4cd686838b$var$O(e) {\n    if (Object.prototype.hasOwnProperty.call(this, e)) {\n        const t = this[e];\n        delete this[e], this[e] = t;\n    }\n}\n$81b28a4cd686838b$export$f0e45424cc896229.defineCustomElement();\n\n\nObject.defineProperty({}, \"CapturePhoto\", {\n    get: function() {\n        return $636b0cf1ed0b9f88$export$cc30a98fe3890794;\n    },\n    set: void 0,\n    enumerable: !0,\n    configurable: !0\n});\nlet $636b0cf1ed0b9f88$var$t = (t, e, i)=>(Number.isNaN(e) && (e = 0), Number.isNaN(i) && (i = 0), Math.min(Math.max(t, Math.min(e, i)), Math.max(e, i))), $636b0cf1ed0b9f88$var$e = \"capture-photo\", $636b0cf1ed0b9f88$var$i = `\n  :host {\n    display: block;\n    box-sizing: border-box;\n  }\n\n  :host *,\n  :host *::before,\n  :host *::after {\n    box-sizing: inherit;\n  }\n\n  :host([hidden]),\n  [hidden],\n  ::slotted([hidden]) {\n    display: none;\n  }\n\n  video {\n    display: block;\n  }\n\n  #output:empty {\n    display: none;\n  }\n`, $636b0cf1ed0b9f88$var$o = document.createElement(\"template\");\n$636b0cf1ed0b9f88$var$o.innerHTML = `\n  <style>${$636b0cf1ed0b9f88$var$i}</style>\n\n  <video part=\"video\" playsinline></video>\n\n  <canvas hidden></canvas>\n\n  <div part=\"actions-container\">\n    <slot name=\"capture-button\">\n      <button part=\"capture-button\" type=\"button\">\n        <slot name=\"capture-button-content\">Capture photo</slot>\n      </button>\n    </slot>\n\n    <slot name=\"facing-mode-button\" hidden>\n      <button part=\"facing-mode-button\" type=\"button\">\n        <slot name=\"facing-mode-button-content\">Toggle facing mode</slot>\n      </button>\n    </slot>\n\n    <slot name=\"actions\"></slot>\n  </div>\n\n  <slot></slot>\n\n  <div part=\"output-container\" id=\"output\"></div>\n`;\nclass $636b0cf1ed0b9f88$export$cc30a98fe3890794 extends HTMLElement {\n    #t = {};\n    #e = null;\n    #i = null;\n    #o = null;\n    #n = null;\n    #a = null;\n    #s = null;\n    #r = null;\n    #l = null;\n    constructor(){\n        super(), this.#t = this.getSupportedConstraints(), this.shadowRoot || this.attachShadow({\n            mode: \"open\"\n        }).appendChild($636b0cf1ed0b9f88$var$o.content.cloneNode(!0));\n    }\n    static get observedAttributes() {\n        return [\n            \"no-image\",\n            \"facing-mode\",\n            \"camera-resolution\",\n            \"pan\",\n            \"tilt\",\n            \"zoom\"\n        ];\n    }\n    attributeChangedCallback(t, e, i) {\n        if (!this.isConnected) return;\n        let o = this.getTrackCapabilities(), n = this.getTrackSettings();\n        if (\"no-image\" === t && e !== i && this.#u(), \"facing-mode\" === t && e !== i && \"facingMode\" in this.#t) {\n            let t = [\n                \"user\",\n                \"environment\"\n            ].includes(this.facingMode || \"\");\n            \"facingMode\" in n && t && (this.stopVideoStream(), this.startVideoStream());\n        }\n        if (\"camera-resolution\" === t && e !== i && \"string\" == typeof this.cameraResolution && this.cameraResolution.trim().length > 0) {\n            let [t = 0, e = 0] = this.cameraResolution.split(\"x\").map((t)=>Number(t));\n            if (t > 0 && e > 0 && \"width\" in o && \"height\" in o) {\n                let i = !!(o.width?.min && o.width?.max) && t >= o?.width?.min && t <= o?.width?.max, a = !!(o.height?.min && o.height?.max) && e >= o?.height?.min && e <= o?.height?.max;\n                \"width\" in n && \"height\" in n && i && a && (this.stopVideoStream(), this.startVideoStream());\n            }\n        }\n        if (\"pan\" === t && e !== i && \"pan\" in this.#t) {\n            let t = !!(\"pan\" in o && o.pan?.min && o.pan?.max) && this.pan >= o.pan.min && this.pan <= o.pan.max;\n            \"pan\" in n && \"number\" == typeof this.pan && t && this.#h(\"pan\", this.pan);\n        }\n        if (\"tilt\" === t && e !== i && \"tilt\" in this.#t) {\n            let t = !!(\"tilt\" in o && o.tilt?.min && o.tilt?.max) && this.tilt >= o.tilt.min && this.tilt <= o.tilt.max;\n            \"tilt\" in n && \"number\" == typeof this.tilt && t && this.#h(\"tilt\", this.tilt);\n        }\n        if (\"zoom\" === t && e !== i && \"zoom\" in this.#t) {\n            let t = !!(\"zoom\" in o && o.zoom?.min && o.zoom?.max) && this.zoom >= o.zoom.min && this.zoom <= o.zoom.max;\n            \"zoom\" in n && \"number\" == typeof this.zoom && t && this.#h(\"zoom\", this.zoom);\n        }\n    }\n    connectedCallback() {\n        if (this.#d(\"autpoPlay\"), this.#d(\"noImage\"), this.#d(\"facingMode\"), this.#d(\"cameraResolution\"), this.#d(\"pan\"), this.#d(\"tilt\"), this.#d(\"zoom\"), this.#d(\"calculateFileSize\"), this.#i = this.shadowRoot?.querySelector(\"canvas\") || null, this.#o = this.shadowRoot?.getElementById(\"output\") || null, this.#n = this.shadowRoot?.querySelector(\"video\") || null, this.#a = this.shadowRoot?.querySelector('slot[name=\"capture-button\"]') || null, this.#s = this.#c(), this.#r = this.shadowRoot?.querySelector('slot[name=\"facing-mode-button\"]') || null, this.#l = this.#m(), this.#n?.addEventListener(\"loadedmetadata\", this.#p), this.#a?.addEventListener(\"slotchange\", this.#g), this.#s?.addEventListener(\"click\", this.#b), this.#r?.addEventListener(\"slotchange\", this.#f), this.#l?.addEventListener(\"click\", this.#v), !$636b0cf1ed0b9f88$export$cc30a98fe3890794.isSupported()) return this.dispatchEvent(new CustomEvent(`${$636b0cf1ed0b9f88$var$e}:error`, {\n            bubbles: !0,\n            composed: !0,\n            detail: {\n                error: {\n                    name: \"NotSupportedError\",\n                    message: \"Not supported\"\n                }\n            }\n        }));\n        this.autoPlay && this.startVideoStream();\n    }\n    disconnectedCallback() {\n        this.stopVideoStream(), this.#l?.removeEventListener(\"click\", this.#v), this.#s?.removeEventListener(\"click\", this.#b), this.#n?.removeEventListener(\"canplay\", this.#p), this.#a?.removeEventListener(\"slotchange\", this.#g), this.#r?.removeEventListener(\"slotchange\", this.#f);\n    }\n    get autoPlay() {\n        return this.hasAttribute(\"auto-play\");\n    }\n    set autoPlay(t) {\n        this.toggleAttribute(\"auto-play\", !!t);\n    }\n    get noImage() {\n        return this.hasAttribute(\"no-image\");\n    }\n    set noImage(t) {\n        this.toggleAttribute(\"no-image\", !!t);\n    }\n    get facingMode() {\n        return this.getAttribute(\"facing-mode\") || \"user\";\n    }\n    set facingMode(t) {\n        this.setAttribute(\"facing-mode\", t);\n    }\n    get cameraResolution() {\n        return this.getAttribute(\"camera-resolution\") || \"\";\n    }\n    set cameraResolution(t) {\n        this.setAttribute(\"camera-resolution\", t);\n    }\n    get pan() {\n        return Number(this.getAttribute(\"pan\")) || 0;\n    }\n    set pan(t) {\n        this.setAttribute(\"pan\", null != t ? t.toString() : t);\n    }\n    get tilt() {\n        return Number(this.getAttribute(\"tilt\")) || 0;\n    }\n    set tilt(t) {\n        this.setAttribute(\"tilt\", null != t ? t.toString() : t);\n    }\n    get zoom() {\n        return Number(this.getAttribute(\"zoom\")) || 1;\n    }\n    set zoom(t) {\n        this.setAttribute(\"zoom\", null != t ? t.toString() : t);\n    }\n    get loading() {\n        return this.hasAttribute(\"loading\");\n    }\n    get calculateFileSize() {\n        return this.hasAttribute(\"calculate-file-size\");\n    }\n    set calculateFileSize(t) {\n        this.toggleAttribute(\"calculate-file-size\", !!t);\n    }\n    #v = (t)=>{\n        t.preventDefault(), this.loading || (this.facingMode = \"user\" !== this.facingMode && this.facingMode ? \"user\" : \"environment\");\n    };\n    #b = (t)=>{\n        t.preventDefault(), this.capture();\n    };\n    #p = (t)=>{\n        let i = t.target;\n        i.play().then(()=>{\n            this.dispatchEvent(new CustomEvent(`${$636b0cf1ed0b9f88$var$e}:video-play`, {\n                bubbles: !0,\n                composed: !0,\n                detail: {\n                    video: i\n                }\n            }));\n        }).catch((t)=>{\n            this.dispatchEvent(new CustomEvent(`${$636b0cf1ed0b9f88$var$e}:error`, {\n                bubbles: !0,\n                composed: !0,\n                detail: {\n                    error: t\n                }\n            }));\n        }).finally(()=>{\n            this.removeAttribute(\"loading\");\n        });\n    };\n    #u() {\n        this.#o && Array.from(this.#o.childNodes).forEach((t)=>t.remove());\n    }\n    #h(e, i) {\n        if (!this.#e || !e || !i) return;\n        let [o] = this.#e.getVideoTracks(), n = this.getTrackCapabilities();\n        e in this.getTrackSettings() && o.applyConstraints({\n            advanced: [\n                {\n                    [e]: $636b0cf1ed0b9f88$var$t(Number(i), n[e]?.min || 1, n[e]?.max || 1)\n                }\n            ]\n        });\n    }\n    #g = (t)=>{\n        t.target?.name === \"capture-button\" && (this.#s?.removeEventListener(\"click\", this.#b), this.#s = this.#c(), this.#s && (this.#s.addEventListener(\"click\", this.#b), \"BUTTON\" === this.#s.nodeName || this.#s.hasAttribute(\"role\") || this.#s.setAttribute(\"role\", \"button\")));\n    };\n    #f = (t)=>{\n        t.target?.name === \"facing-mode-button\" && (this.#l?.removeEventListener(\"click\", this.#v), this.#l = this.#m(), this.#l && (this.#l.addEventListener(\"click\", this.#v), \"BUTTON\" === this.#l.nodeName || this.#l.hasAttribute(\"role\") || this.#l.setAttribute(\"role\", \"button\")));\n    };\n    #m() {\n        return this.#r && this.#r.assignedElements({\n            flatten: !0\n        }).find((t)=>\"BUTTON\" === t.nodeName || \"facing-mode-button\" === t.getAttribute(\"slot\")) || null;\n    }\n    #c() {\n        return this.#a && this.#a.assignedElements({\n            flatten: !0\n        }).find((t)=>\"BUTTON\" === t.nodeName || \"capture-button\" === t.getAttribute(\"slot\")) || null;\n    }\n    #d(t) {\n        if (Object.prototype.hasOwnProperty.call(this, t)) {\n            let e = this[t];\n            delete this[t], this[t] = e;\n        }\n    }\n    async startVideoStream() {\n        if (!$636b0cf1ed0b9f88$export$cc30a98fe3890794.isSupported() || this.#e) return;\n        this.setAttribute(\"loading\", \"\");\n        let t = {\n            video: {\n                facingMode: {\n                    ideal: this.facingMode || \"user\"\n                },\n                pan: !0,\n                tilt: !0,\n                zoom: !0\n            },\n            audio: !1\n        };\n        if (\"string\" == typeof this.cameraResolution && this.cameraResolution.trim().length > 0) {\n            let [e = 0, i = 0] = this.cameraResolution.split(\"x\").map((t)=>Number(t));\n            e > 0 && i > 0 && (t.video.width = e, t.video.height = i);\n        }\n        try {\n            this.#e = await navigator.mediaDevices.getUserMedia(t), this.#n && (this.#n.srcObject = this.#e), this.#h(\"pan\", this.pan), this.#h(\"tilt\", this.tilt), this.#h(\"zoom\", this.zoom);\n            let e = this.getTrackSettings();\n            \"facingMode\" in e && this.#r && (this.#r.hidden = !1);\n        } catch (t) {\n            this.dispatchEvent(new CustomEvent(`${$636b0cf1ed0b9f88$var$e}:error`, {\n                bubbles: !0,\n                composed: !0,\n                detail: {\n                    error: t\n                }\n            }));\n        } finally{\n            this.removeAttribute(\"loading\");\n        }\n    }\n    stopVideoStream() {\n        if (!this.#n || !this.#e) return;\n        let [t] = this.#e.getVideoTracks();\n        t?.stop(), this.#n.srcObject = null, this.#e = null;\n    }\n    async capture() {\n        if (!this.loading && this.#i && this.#n) try {\n            let t = this.#i.getContext(\"2d\"), i = this.#n.videoWidth, o = this.#n.videoHeight;\n            this.#i.width = i, this.#i.height = o, t?.drawImage(this.#n, 0, 0, i, o);\n            let n = this.#i.toDataURL(\"image/png\");\n            if (\"string\" == typeof n && n.includes(\"data:image\")) {\n                if (!this.noImage) {\n                    let t = new Image;\n                    t.src = n, t.width = i, t.height = o, t.setAttribute(\"part\", \"output-image\"), this.#u(), this.#o?.appendChild(t);\n                }\n                let t = {\n                    dataURI: n,\n                    width: i,\n                    height: o\n                };\n                if (this.calculateFileSize) try {\n                    let e = await fetch(n), i = (await e.blob()).size;\n                    i && (t.size = i);\n                } catch (t) {}\n                this.dispatchEvent(new CustomEvent(`${$636b0cf1ed0b9f88$var$e}:success`, {\n                    bubbles: !0,\n                    composed: !0,\n                    detail: t\n                }));\n            }\n        } catch (t) {\n            this.dispatchEvent(new CustomEvent(`${$636b0cf1ed0b9f88$var$e}:error`, {\n                bubbles: !0,\n                composed: !0,\n                detail: {\n                    error: t\n                }\n            }));\n        }\n    }\n    getSupportedConstraints() {\n        return $636b0cf1ed0b9f88$export$cc30a98fe3890794.isSupported() && navigator.mediaDevices.getSupportedConstraints() || {};\n    }\n    getTrackCapabilities() {\n        if (!this.#e) return {};\n        let [t] = this.#e.getVideoTracks();\n        return t && \"function\" == typeof t.getCapabilities && t.getCapabilities() || {};\n    }\n    getTrackSettings() {\n        if (!this.#e) return {};\n        let [t] = this.#e.getVideoTracks();\n        return t && \"function\" == typeof t.getSettings && t.getSettings() || {};\n    }\n    static isSupported() {\n        return !!navigator.mediaDevices?.getUserMedia;\n    }\n    static defineCustomElement(t = $636b0cf1ed0b9f88$var$e) {\n        \"undefined\" == typeof window || window.customElements.get(t) || window.customElements.define(t, $636b0cf1ed0b9f88$export$cc30a98fe3890794);\n    }\n}\n$636b0cf1ed0b9f88$export$cc30a98fe3890794.defineCustomElement();\n\n\nfunction $e92a13782f6c06ba$var$_slicedToArray(arr, i) {\n    return $e92a13782f6c06ba$var$_arrayWithHoles(arr) || $e92a13782f6c06ba$var$_iterableToArrayLimit(arr, i) || $e92a13782f6c06ba$var$_unsupportedIterableToArray(arr, i) || $e92a13782f6c06ba$var$_nonIterableRest();\n}\nfunction $e92a13782f6c06ba$var$_nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction $e92a13782f6c06ba$var$_unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return $e92a13782f6c06ba$var$_arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return $e92a13782f6c06ba$var$_arrayLikeToArray(o, minLen);\n}\nfunction $e92a13782f6c06ba$var$_arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n    for(var i = 0, arr2 = new Array(len); i < len; i++)arr2[i] = arr[i];\n    return arr2;\n}\nfunction $e92a13782f6c06ba$var$_iterableToArrayLimit(arr, i) {\n    var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n    if (_i == null) return;\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _s, _e;\n    try {\n        for(_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true){\n            _arr.push(_s.value);\n            if (i && _arr.length === i) break;\n        }\n    } catch (err) {\n        _d = true;\n        _e = err;\n    } finally{\n        try {\n            if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n        } finally{\n            if (_d) throw _e;\n        }\n    }\n    return _arr;\n}\nfunction $e92a13782f6c06ba$var$_arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n}\nfunction $e92a13782f6c06ba$export$b327150396135fe7(request) {\n    return new Promise(function(resolve, reject) {\n        // @ts-ignore - file size hacks\n        request.oncomplete = request.onsuccess = function() {\n            return resolve(request.result);\n        }; // @ts-ignore - file size hacks\n        request.onabort = request.onerror = function() {\n            return reject(request.error);\n        };\n    });\n}\nfunction $e92a13782f6c06ba$export$f51a9068ac82ea43(dbName, storeName) {\n    var request = indexedDB.open(dbName);\n    request.onupgradeneeded = function() {\n        return request.result.createObjectStore(storeName);\n    };\n    var dbp = $e92a13782f6c06ba$export$b327150396135fe7(request);\n    return function(txMode, callback) {\n        return dbp.then(function(db) {\n            return callback(db.transaction(storeName, txMode).objectStore(storeName));\n        });\n    };\n}\nvar $e92a13782f6c06ba$var$defaultGetStoreFunc;\nfunction $e92a13782f6c06ba$var$defaultGetStore() {\n    if (!$e92a13782f6c06ba$var$defaultGetStoreFunc) $e92a13782f6c06ba$var$defaultGetStoreFunc = $e92a13782f6c06ba$export$f51a9068ac82ea43(\"keyval-store\", \"keyval\");\n    return $e92a13782f6c06ba$var$defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$3988ae62b71be9a3(key) {\n    var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readonly\", function(store) {\n        return $e92a13782f6c06ba$export$b327150396135fe7(store.get(key));\n    });\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$adaa4cf7ef1b65be(key, value) {\n    var customStore = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readwrite\", function(store) {\n        store.put(value, key);\n        return $e92a13782f6c06ba$export$b327150396135fe7(store.transaction);\n    });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic  if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$daa0a5170277c7a8(entries) {\n    var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readwrite\", function(store) {\n        entries.forEach(function(entry) {\n            return store.put(entry[1], entry[0]);\n        });\n        return $e92a13782f6c06ba$export$b327150396135fe7(store.transaction);\n    });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$5df405cccea42673(keys) {\n    var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readonly\", function(store) {\n        return Promise.all(keys.map(function(key) {\n            return $e92a13782f6c06ba$export$b327150396135fe7(store.get(key));\n        }));\n    });\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$722fbec263ad908a(key, updater) {\n    var customStore = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readwrite\", function(store) {\n        return(// If I try to chain promises, the transaction closes in browsers\n        // that use a promise polyfill (IE10/11).\n        new Promise(function(resolve, reject) {\n            store.get(key).onsuccess = function() {\n                try {\n                    store.put(updater(this.result), key);\n                    resolve($e92a13782f6c06ba$export$b327150396135fe7(store.transaction));\n                } catch (err) {\n                    reject(err);\n                }\n            };\n        }));\n    });\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$1d2f21e549771e67(key) {\n    var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readwrite\", function(store) {\n        store.delete(key);\n        return $e92a13782f6c06ba$export$b327150396135fe7(store.transaction);\n    });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$c8aa84257229cac8(keys) {\n    var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readwrite\", function(store) {\n        keys.forEach(function(key) {\n            return store.delete(key);\n        });\n        return $e92a13782f6c06ba$export$b327150396135fe7(store.transaction);\n    });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$42ffd38884aecdac() {\n    var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readwrite\", function(store) {\n        store.clear();\n        return $e92a13782f6c06ba$export$b327150396135fe7(store.transaction);\n    });\n}\nfunction $e92a13782f6c06ba$var$eachCursor(store, callback) {\n    store.openCursor().onsuccess = function() {\n        if (!this.result) return;\n        callback(this.result);\n        this.result.continue();\n    };\n    return $e92a13782f6c06ba$export$b327150396135fe7(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$ed97f33186d4b816() {\n    var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readonly\", function(store) {\n        // Fast path for modern browsers\n        if (store.getAllKeys) return $e92a13782f6c06ba$export$b327150396135fe7(store.getAllKeys());\n        var items = [];\n        return $e92a13782f6c06ba$var$eachCursor(store, function(cursor) {\n            return items.push(cursor.key);\n        }).then(function() {\n            return items;\n        });\n    });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$68c286be0e7e55b7() {\n    var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readonly\", function(store) {\n        // Fast path for modern browsers\n        if (store.getAll) return $e92a13782f6c06ba$export$b327150396135fe7(store.getAll());\n        var items = [];\n        return $e92a13782f6c06ba$var$eachCursor(store, function(cursor) {\n            return items.push(cursor.value);\n        }).then(function() {\n            return items;\n        });\n    });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */ function $e92a13782f6c06ba$export$3e9f948b41964866() {\n    var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : $e92a13782f6c06ba$var$defaultGetStore();\n    return customStore(\"readonly\", function(store) {\n        // Fast path for modern browsers\n        // (although, hopefully we'll get a simpler path some day)\n        if (store.getAll && store.getAllKeys) return Promise.all([\n            $e92a13782f6c06ba$export$b327150396135fe7(store.getAllKeys()),\n            $e92a13782f6c06ba$export$b327150396135fe7(store.getAll())\n        ]).then(function(_ref) {\n            var _ref2 = $e92a13782f6c06ba$var$_slicedToArray(_ref, 2), keys = _ref2[0], values = _ref2[1];\n            return keys.map(function(key, i) {\n                return [\n                    key,\n                    values[i]\n                ];\n            });\n        });\n        var items = [];\n        return customStore(\"readonly\", function(store) {\n            return $e92a13782f6c06ba$var$eachCursor(store, function(cursor) {\n                return items.push([\n                    cursor.key,\n                    cursor.value\n                ]);\n            }).then(function() {\n                return items;\n            });\n        });\n    });\n}\n\n\nconst $c96efe8837e99c11$var$STORAGE_PREFIX = \"barcode-scanner/\";\nconst $c96efe8837e99c11$var$SETTINGS_STORAGE_KEY = \"settings\";\nconst $c96efe8837e99c11$var$HISTORY_STORAGE_KEY = \"history\";\nconst $c96efe8837e99c11$var$getItem = async (key)=>{\n    try {\n        return {\n            value: await (0, $e92a13782f6c06ba$export$3988ae62b71be9a3)(key),\n            error: void 0\n        };\n    } catch (error) {\n        return {\n            value: void 0,\n            error: error\n        };\n    }\n};\nconst $c96efe8837e99c11$var$setItem = async (key, data)=>{\n    try {\n        await (0, $e92a13782f6c06ba$export$adaa4cf7ef1b65be)(key, data);\n        return {\n            error: void 0\n        };\n    } catch (error) {\n        return {\n            error: error\n        };\n    }\n};\nconst $c96efe8837e99c11$export$4a647155031ece = async ()=>{\n    return $c96efe8837e99c11$var$getItem($c96efe8837e99c11$var$STORAGE_PREFIX + $c96efe8837e99c11$var$SETTINGS_STORAGE_KEY);\n};\nconst $c96efe8837e99c11$export$dc86d17a64679bc7 = async (data)=>{\n    return $c96efe8837e99c11$var$setItem($c96efe8837e99c11$var$STORAGE_PREFIX + $c96efe8837e99c11$var$SETTINGS_STORAGE_KEY, data);\n};\nconst $c96efe8837e99c11$export$f9582a3c130d9538 = async ()=>{\n    return $c96efe8837e99c11$var$getItem($c96efe8837e99c11$var$STORAGE_PREFIX + $c96efe8837e99c11$var$HISTORY_STORAGE_KEY);\n};\nconst $c96efe8837e99c11$export$96fe1132eb44c325 = async (data)=>{\n    return $c96efe8837e99c11$var$setItem($c96efe8837e99c11$var$STORAGE_PREFIX + $c96efe8837e99c11$var$HISTORY_STORAGE_KEY, data);\n};\n\n\n\nvar $5Gd8p = parcelRequire(\"5Gd8p\");\n\nvar $kkiei = parcelRequire(\"kkiei\");\n// src/js/services/product-service.js\n\nvar $6m2hf = parcelRequire(\"6m2hf\");\n\nvar $5Gd8p = parcelRequire(\"5Gd8p\");\nconst $6d70e5dcf1eba205$export$99c80bd423f4415 = async (barcode)=>{\n    const productDoc = await (0, $6m2hf.getDoc)((0, $6m2hf.doc)((0, $5Gd8p.db), \"products\", barcode));\n    if (productDoc.exists()) return {\n        id: productDoc.id,\n        ...productDoc.data()\n    };\n    return null;\n};\nconst $6d70e5dcf1eba205$export$9c734a715e6666d0 = async (barcode, productData)=>{\n    // Handle both string (name only) and object formats\n    const name = typeof productData === \"string\" ? productData : productData?.name;\n    const description = typeof productData === \"object\" ? productData?.description || \"\" : \"\";\n    const imageUrl = typeof productData === \"object\" ? productData?.imageUrl || null : null;\n    const category = typeof productData === \"object\" ? productData?.category || \"uncategorized\" : \"uncategorized\";\n    const product = {\n        barcode: barcode,\n        name: name,\n        description: description,\n        imageUrl: imageUrl,\n        category: category,\n        createdAt: (0, $6m2hf.serverTimestamp)(),\n        updatedAt: (0, $6m2hf.serverTimestamp)()\n    };\n    await (0, $6m2hf.setDoc)((0, $6m2hf.doc)((0, $5Gd8p.db), \"products\", barcode), product);\n    return product;\n};\nconst $6d70e5dcf1eba205$export$8d590d0c8872145e = async (barcode, updates)=>{\n    const productRef = (0, $6m2hf.doc)((0, $5Gd8p.db), \"products\", barcode);\n    await (0, $6m2hf.updateDoc)(productRef, {\n        ...updates,\n        updatedAt: (0, $6m2hf.serverTimestamp)()\n    });\n};\nconst $6d70e5dcf1eba205$export$3e4ea1d0bd1fe003 = async (searchTerm)=>{\n    const productsRef = (0, $6m2hf.collection)((0, $5Gd8p.db), \"products\");\n    const snapshot = await (0, $6m2hf.getDocs)(productsRef);\n    const products = [];\n    const searchLower = searchTerm.toLowerCase();\n    snapshot.forEach((doc)=>{\n        const data = doc.data();\n        if (data.name && data.name.toLowerCase().includes(searchLower)) products.push({\n            id: doc.id,\n            ...data\n        });\n    });\n    return products;\n};\nconst $6d70e5dcf1eba205$export$6db8ffe3519823c3 = async (barcode, productData)=>{\n    let product = await $6d70e5dcf1eba205$export$99c80bd423f4415(barcode);\n    if (!product && productData) product = await $6d70e5dcf1eba205$export$9c734a715e6666d0(barcode, productData);\n    return product;\n};\n\n\n// Simple toast function\nfunction $29ebe6aa764dae38$var$showToast(message, type = \"success\") {\n    const container = document.getElementById(\"toastContainer\");\n    if (!container) return;\n    const toast = document.createElement(\"div\");\n    toast.className = `toast ${type}`;\n    toast.textContent = message;\n    container.appendChild(toast);\n    setTimeout(()=>toast.remove(), 3000);\n}\n\n(async function() {\n    // Check if logged in\n    const currentFridgeCode = (0, $kkiei.getCurrentFridgeCode)();\n    if (!currentFridgeCode) {\n        window.location.href = \"index.html\";\n        return;\n    }\n    const capturePhotoEl = document.querySelector(\"capture-photo\");\n    const scanInstructionsEl = document.getElementById(\"scanInstructions\");\n    const rescanBtn = document.getElementById(\"rescanBtn\");\n    const scanFrameEl = document.getElementById(\"scanFrame\");\n    const settingsBtn = document.getElementById(\"settingsBtn\");\n    const settingsDialog = document.getElementById(\"settingsDialog\");\n    const settingsForm = document.forms[\"settings-form\"];\n    const productDialog = document.getElementById(\"productDialog\");\n    const productForm = document.getElementById(\"productForm\");\n    const productBarcodeInput = document.getElementById(\"productBarcode\");\n    const productNameInput = document.getElementById(\"productName\");\n    const productQuantityInput = document.getElementById(\"productQuantity\");\n    let shouldRepeatScan = true;\n    let isScanning = false;\n    let rafId;\n    let capturePhotoVideoEl = null;\n    // Initialize Firebase\n    try {\n        await (0, $5Gd8p.initializeFirebase)();\n        console.log(\"Firebase ready\");\n    } catch (err) {\n        console.error(\"Firebase init error:\", err);\n    }\n    // Load BarcodeDetector\n    if (!(\"BarcodeDetector\" in window)) try {\n        await (parcelRequire(\"3c8ZQ\"));\n        console.log(\"Using BarcodeDetector polyfill.\");\n    } catch (err) {\n        return $29ebe6aa764dae38$var$showToast(\"Strekkodeskanning st\\xf8ttes ikke i denne nettleseren.\", \"danger\");\n    }\n    const formats = await window.BarcodeDetector.getSupportedFormats();\n    const barcodeDetector = new window.BarcodeDetector({\n        formats: formats\n    });\n    // Load settings\n    const { value: settings = {\n        beep: true,\n        vibrate: true\n    } } = await (0, $c96efe8837e99c11$export$4a647155031ece)();\n    Object.entries(settings).forEach(([key, value])=>{\n        const input = settingsForm?.querySelector(`[name=\"${key}\"]`);\n        if (input) input.checked = value;\n    });\n    // Video element getter\n    const getVideoElement = ()=>{\n        if (!capturePhotoVideoEl) capturePhotoVideoEl = capturePhotoEl?.shadowRoot?.querySelector(\"video\");\n        return capturePhotoVideoEl;\n    };\n    // AudioContext (lazy init to handle mobile gesture requirement)\n    let audioCtx = null;\n    const getAudioContext = ()=>{\n        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n        // Resume if suspended (mobile browsers)\n        if (audioCtx.state === \"suspended\") audioCtx.resume();\n        return audioCtx;\n    };\n    // Beep function\n    const beep = async (duration = 200, frequency = 860, volume = 0.03)=>{\n        const { value: settings } = await (0, $c96efe8837e99c11$export$4a647155031ece)();\n        // Default to true if settings not set\n        if (settings?.beep === false) return;\n        try {\n            const ctx = getAudioContext();\n            const oscillator = ctx.createOscillator();\n            const gainNode = ctx.createGain();\n            oscillator.connect(gainNode);\n            gainNode.connect(ctx.destination);\n            gainNode.gain.value = volume;\n            oscillator.frequency.value = frequency;\n            oscillator.type = \"square\";\n            oscillator.start(ctx.currentTime);\n            oscillator.stop(ctx.currentTime + duration / 1000);\n        } catch (err) {\n            console.log(\"Beep failed:\", err);\n        }\n    };\n    // Vibrate function\n    async function vibrate(duration = 100) {\n        const { value: settings } = await (0, $c96efe8837e99c11$export$4a647155031ece)();\n        // Default to true if settings not set\n        if (settings?.vibrate === false) return;\n        if (typeof navigator.vibrate !== \"function\") return;\n        try {\n            navigator.vibrate(duration);\n        } catch (err) {\n            console.log(\"Vibrate failed:\", err);\n        }\n    }\n    // Resize scan frame\n    function resizeScanFrame(videoEl) {\n        if (!videoEl || !scanFrameEl) return;\n        const rect = videoEl.getBoundingClientRect();\n        scanFrameEl.style.cssText = `width: ${Math.min(rect.width * 0.8, 280)}px; height: ${Math.min(rect.height * 0.5, 200)}px`;\n    }\n    // Detect barcode\n    function detectBarcode(source) {\n        return new Promise((resolve, reject)=>{\n            barcodeDetector.detect(source).then((results)=>{\n                if (Array.isArray(results) && results.length > 0) resolve(results[0]);\n                else reject({\n                    message: \"No barcode detected\"\n                });\n            }).catch(reject);\n        });\n    }\n    // Start scanning\n    function startScanning() {\n        shouldRepeatScan = true;\n        isScanning = true;\n        if (rescanBtn) rescanBtn.hidden = true;\n        if (scanFrameEl) scanFrameEl.hidden = false;\n        if (scanInstructionsEl) scanInstructionsEl.hidden = false;\n        scan();\n    }\n    // Stop scanning\n    function stopScanning() {\n        shouldRepeatScan = false;\n        isScanning = false;\n        window.cancelAnimationFrame(rafId);\n        if (rescanBtn) rescanBtn.hidden = false;\n        if (scanFrameEl) scanFrameEl.hidden = true;\n        if (scanInstructionsEl) scanInstructionsEl.hidden = true;\n    }\n    // Main scan loop\n    async function scan() {\n        if (!isScanning) return;\n        try {\n            const videoEl = getVideoElement();\n            if (!videoEl || videoEl.readyState < 2) {\n                if (shouldRepeatScan) rafId = window.requestAnimationFrame(()=>scan());\n                return;\n            }\n            const barcode = await detectBarcode(videoEl);\n            if (!barcode?.rawValue) throw new Error(\"No barcode value\");\n            console.log(\"\\u2713 Barcode detected:\", barcode.rawValue);\n            // Stop scanning temporarily\n            stopScanning();\n            beep(200, 860, 0.03);\n            vibrate();\n            // Handle the barcode - add to fridge\n            await handleBarcodeDetected(barcode.rawValue);\n            return;\n        } catch  {}\n        if (shouldRepeatScan) rafId = window.requestAnimationFrame(()=>scan());\n    }\n    // Handle barcode detection - always show dialog, pre-fill if product exists\n    async function handleBarcodeDetected(barcode) {\n        // Check if product exists\n        const product = await (0, $6d70e5dcf1eba205$export$99c80bd423f4415)(barcode);\n        // Always show dialog, pre-fill name if product exists\n        showProductDialog(barcode, product?.name || \"\");\n    }\n    // Show product dialog with optional pre-filled name\n    function showProductDialog(barcode, existingName = \"\") {\n        if (!productDialog) return;\n        productBarcodeInput.value = barcode;\n        productNameInput.value = existingName;\n        productQuantityInput.value = \"1\";\n        productDialog.showModal();\n        if (existingName) {\n            // If name is pre-filled, focus on quantity instead\n            productQuantityInput.focus();\n            productQuantityInput.select();\n        } else productNameInput.focus();\n    }\n    // Handle product form submit\n    async function handleAddProduct() {\n        const barcode = productBarcodeInput?.value;\n        const name = productNameInput?.value?.trim();\n        const quantity = parseInt(productQuantityInput?.value) || 1;\n        if (!barcode || !name) return;\n        try {\n            // Check if product exists to see if we need to update\n            const existingProduct = await (0, $6d70e5dcf1eba205$export$99c80bd423f4415)(barcode);\n            if (existingProduct) // Product exists - update name if changed\n            {\n                if (existingProduct.name !== name) await (0, $6d70e5dcf1eba205$export$8d590d0c8872145e)(barcode, {\n                    name: name\n                });\n            } else // Create new product\n            await (0, $6d70e5dcf1eba205$export$9c734a715e6666d0)(barcode, name);\n            // Add to fridge with quantity\n            await (0, $kkiei.addToFridge)(barcode, {\n                name: name\n            }, quantity);\n            productDialog?.close();\n            $29ebe6aa764dae38$var$showToast(`${name} lagt til!`, \"success\");\n        } catch (err) {\n            $29ebe6aa764dae38$var$showToast(\"Feil: \" + err.message, \"danger\");\n        }\n    }\n    // Event: Video starts playing\n    capturePhotoEl?.addEventListener(\"capture-photo:video-play\", (evt)=>{\n        capturePhotoVideoEl = evt.detail.video || capturePhotoEl.shadowRoot?.querySelector(\"video\");\n        resizeScanFrame(capturePhotoVideoEl);\n        startScanning();\n        // Setup zoom if available\n        const trackSettings = capturePhotoEl.getTrackSettings();\n        const trackCapabilities = capturePhotoEl.getTrackCapabilities();\n        const zoomLevelEl = document.getElementById(\"zoomLevel\");\n        const zoomControls = document.getElementById(\"zoomControls\");\n        if (trackSettings?.zoom && trackCapabilities?.zoom) {\n            const minZoom = trackCapabilities.zoom.min || 1;\n            const maxZoom = trackCapabilities.zoom.max || 10;\n            let currentZoom = trackSettings.zoom || 1;\n            if (zoomControls) zoomControls.hidden = false;\n            if (zoomLevelEl) zoomLevelEl.textContent = currentZoom.toFixed(1);\n            zoomControls?.addEventListener(\"click\", (evt)=>{\n                const action = evt.target.closest(\"button\")?.dataset.action;\n                if (action === \"zoom-in\" && currentZoom < maxZoom) currentZoom += 0.5;\n                if (action === \"zoom-out\" && currentZoom > minZoom) currentZoom -= 0.5;\n                if (zoomLevelEl) zoomLevelEl.textContent = currentZoom.toFixed(1);\n                capturePhotoEl.zoom = currentZoom;\n            });\n        }\n    });\n    // Event: Rescan button click\n    rescanBtn?.addEventListener(\"click\", ()=>{\n        startScanning();\n    });\n    // Event: Settings\n    settingsBtn?.addEventListener(\"click\", ()=>settingsDialog?.showModal());\n    settingsDialog?.addEventListener(\"click\", (evt)=>{\n        if (evt.target === evt.currentTarget) settingsDialog.close();\n    });\n    settingsForm?.addEventListener(\"change\", (evt)=>{\n        const settings = {};\n        settingsForm.querySelectorAll('input[type=\"checkbox\"]').forEach((cb)=>{\n            settings[cb.name] = cb.checked;\n        });\n        (0, $c96efe8837e99c11$export$dc86d17a64679bc7)(settings);\n    });\n    // Event: Product form\n    productForm?.addEventListener(\"submit\", async (e)=>{\n        e.preventDefault();\n        await handleAddProduct();\n    });\n    document.getElementById(\"skipProductBtn\")?.addEventListener(\"click\", ()=>{\n        productDialog?.close();\n        // Resume scanning after closing dialog\n        startScanning();\n    });\n    productDialog?.addEventListener(\"click\", (evt)=>{\n        if (evt.target === evt.currentTarget) {\n            productDialog.close();\n            // Resume scanning after closing dialog\n            startScanning();\n        }\n    });\n    // Resume scanning after successful add\n    productDialog?.addEventListener(\"close\", ()=>{\n        // Small delay before resuming scan\n        setTimeout(()=>{\n            if (!productDialog.open) startScanning();\n        }, 500);\n    });\n})();\n\n})();\n//# sourceMappingURL=scanner.b2c49530.js.map\n","\"use strict\";\n\nvar mapping = new Map();\nfunction register(baseUrl, manifest) {\n  for (var i = 0; i < manifest.length - 1; i += 2) {\n    mapping.set(manifest[i], {\n      baseUrl: baseUrl,\n      path: manifest[i + 1]\n    });\n  }\n}\nfunction resolve(id) {\n  var resolved = mapping.get(id);\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n  return new URL(resolved.path, resolved.baseUrl).toString();\n}\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","\"use strict\";\n\nvar bundleURL = {};\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n  return value;\n}\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n  return '/';\n}\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\n// TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^/]+/);\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n  return matches[0];\n}\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-manifest').resolve(\"Oreqb\"))).then(() => parcelRequire('dZsGG'));","\"use strict\";\n\nvar cacheLoader = require('../cacheLoader');\nmodule.exports = cacheLoader(function (bundle) {\n  return new Promise(function (resolve, reject) {\n    // Don't insert the same script twice (e.g. if it was already in the HTML)\n    var existingScripts = document.getElementsByTagName('script');\n    if ([].concat(existingScripts).some(function isCurrentBundle(script) {\n      return script.src === bundle;\n    })) {\n      resolve();\n      return;\n    }\n    var preloadLink = document.createElement('link');\n    preloadLink.href = bundle;\n    preloadLink.rel = 'preload';\n    preloadLink.as = 'script';\n    document.head.appendChild(preloadLink);\n    var script = document.createElement('script');\n    script.async = true;\n    script.type = 'text/javascript';\n    script.src = bundle;\n    script.onerror = function (e) {\n      var error = new TypeError(\"Failed to fetch dynamically imported module: \".concat(bundle, \". Error: \").concat(e.message));\n      script.onerror = script.onload = null;\n      script.remove();\n      reject(error);\n    };\n    script.onload = function () {\n      script.onerror = script.onload = null;\n      resolve();\n    };\n    document.getElementsByTagName('head')[0].appendChild(script);\n  });\n});","\"use strict\";\n\nvar cachedBundles = {};\nvar cachedPreloads = {};\nvar cachedPrefetches = {};\nfunction getCache(type) {\n  switch (type) {\n    case 'preload':\n      return cachedPreloads;\n    case 'prefetch':\n      return cachedPrefetches;\n    default:\n      return cachedBundles;\n  }\n}\nmodule.exports = function (loader, type) {\n  return function (bundle) {\n    var cache = getCache(type);\n    if (cache[bundle]) {\n      return cache[bundle];\n    }\n    return cache[bundle] = loader.apply(null, arguments).catch(function (e) {\n      delete cache[bundle];\n      throw e;\n    });\n  };\n};","require('./helpers/bundle-manifest').register(require('./helpers/bundle-url').getBundleURL('hHmRL'),JSON.parse(\"[\\\"hHmRL\\\",\\\"scanner.b2c49530.js\\\",\\\"Oreqb\\\",\\\"es.c8e8eed2.js\\\",\\\"7PPU8\\\",\\\"index.12cd6b58.js\\\"]\"));","// src/js/scanner.js - Simplified scanner for fridge app\r\nimport '@georapbox/resize-observer-element/dist/resize-observer-defined.js';\r\nimport '@georapbox/capture-photo-element/dist/capture-photo-defined.js';\r\nimport { getSettings, setSettings } from './services/storage.js';\r\n\r\n// Firebase / Fridge imports\r\nimport { initializeFirebase } from './services/firebase-config.js';\r\nimport { \r\n  getCurrentFridgeCode,\r\n  addToFridge\r\n} from './services/fridge-service.js';\r\nimport { getProductByBarcode, createProduct, updateProduct } from './services/product-service.js';\r\n\r\n// Simple toast function\r\nfunction showToast(message, type = 'success') {\r\n  const container = document.getElementById('toastContainer');\r\n  if (!container) return;\r\n  \r\n  const toast = document.createElement('div');\r\n  toast.className = `toast ${type}`;\r\n  toast.textContent = message;\r\n  container.appendChild(toast);\r\n  \r\n  setTimeout(() => toast.remove(), 3000);\r\n}\r\n\r\n(async function () {\r\n  // Check if logged in\r\n  const currentFridgeCode = getCurrentFridgeCode();\r\n  if (!currentFridgeCode) {\r\n    window.location.href = 'index.html';\r\n    return;\r\n  }\r\n\r\n  const capturePhotoEl = document.querySelector('capture-photo');\r\n  const scanInstructionsEl = document.getElementById('scanInstructions');\r\n  const rescanBtn = document.getElementById('rescanBtn');\r\n  const scanFrameEl = document.getElementById('scanFrame');\r\n  const settingsBtn = document.getElementById('settingsBtn');\r\n  const settingsDialog = document.getElementById('settingsDialog');\r\n  const settingsForm = document.forms['settings-form'];\r\n  const productDialog = document.getElementById('productDialog');\r\n  const productForm = document.getElementById('productForm');\r\n  const productBarcodeInput = document.getElementById('productBarcode');\r\n  const productNameInput = document.getElementById('productName');\r\n  const productQuantityInput = document.getElementById('productQuantity');\r\n\r\n  let shouldRepeatScan = true;\r\n  let isScanning = false;\r\n  let rafId;\r\n  let capturePhotoVideoEl = null;\r\n\r\n  // Initialize Firebase\r\n  try {\r\n    await initializeFirebase();\r\n    console.log('Firebase ready');\r\n  } catch (err) {\r\n    console.error('Firebase init error:', err);\r\n  }\r\n\r\n  // Load BarcodeDetector\r\n  if (!('BarcodeDetector' in window)) {\r\n    try {\r\n      await import('barcode-detector');\r\n      console.log('Using BarcodeDetector polyfill.');\r\n    } catch (err) {\r\n      return showToast('Strekkodeskanning stttes ikke i denne nettleseren.', 'danger');\r\n    }\r\n  }\r\n\r\n  const formats = await window.BarcodeDetector.getSupportedFormats();\r\n  const barcodeDetector = new window.BarcodeDetector({ formats });\r\n\r\n  // Load settings\r\n  const { value: settings = { beep: true, vibrate: true } } = await getSettings();\r\n  Object.entries(settings).forEach(([key, value]) => {\r\n    const input = settingsForm?.querySelector(`[name=\"${key}\"]`);\r\n    if (input) input.checked = value;\r\n  });\r\n\r\n  // Video element getter\r\n  const getVideoElement = () => {\r\n    if (!capturePhotoVideoEl) {\r\n      capturePhotoVideoEl = capturePhotoEl?.shadowRoot?.querySelector('video');\r\n    }\r\n    return capturePhotoVideoEl;\r\n  };\r\n\r\n  // AudioContext (lazy init to handle mobile gesture requirement)\r\n  let audioCtx = null;\r\n  const getAudioContext = () => {\r\n    if (!audioCtx) {\r\n      audioCtx = new (window.AudioContext || window.webkitAudioContext)();\r\n    }\r\n    // Resume if suspended (mobile browsers)\r\n    if (audioCtx.state === 'suspended') {\r\n      audioCtx.resume();\r\n    }\r\n    return audioCtx;\r\n  };\r\n\r\n  // Beep function\r\n  const beep = async (duration = 200, frequency = 860, volume = 0.03) => {\r\n    const { value: settings } = await getSettings();\r\n    // Default to true if settings not set\r\n    if (settings?.beep === false) return;\r\n\r\n    try {\r\n      const ctx = getAudioContext();\r\n      const oscillator = ctx.createOscillator();\r\n      const gainNode = ctx.createGain();\r\n      oscillator.connect(gainNode);\r\n      gainNode.connect(ctx.destination);\r\n      gainNode.gain.value = volume;\r\n      oscillator.frequency.value = frequency;\r\n      oscillator.type = 'square';\r\n      oscillator.start(ctx.currentTime);\r\n      oscillator.stop(ctx.currentTime + (duration / 1000));\r\n    } catch (err) {\r\n      console.log('Beep failed:', err);\r\n    }\r\n  };\r\n\r\n  // Vibrate function\r\n  async function vibrate(duration = 100) {\r\n    const { value: settings } = await getSettings();\r\n    // Default to true if settings not set\r\n    if (settings?.vibrate === false) return;\r\n    \r\n    if (typeof navigator.vibrate !== 'function') return;\r\n    try { \r\n      navigator.vibrate(duration); \r\n    } catch (err) {\r\n      console.log('Vibrate failed:', err);\r\n    }\r\n  }\r\n\r\n  // Resize scan frame\r\n  function resizeScanFrame(videoEl) {\r\n    if (!videoEl || !scanFrameEl) return;\r\n    const rect = videoEl.getBoundingClientRect();\r\n    scanFrameEl.style.cssText = `width: ${Math.min(rect.width * 0.8, 280)}px; height: ${Math.min(rect.height * 0.5, 200)}px`;\r\n  }\r\n\r\n  // Detect barcode\r\n  function detectBarcode(source) {\r\n    return new Promise((resolve, reject) => {\r\n      barcodeDetector.detect(source).then(results => {\r\n        if (Array.isArray(results) && results.length > 0) {\r\n          resolve(results[0]);\r\n        } else {\r\n          reject({ message: 'No barcode detected' });\r\n        }\r\n      }).catch(reject);\r\n    });\r\n  }\r\n\r\n  // Start scanning\r\n  function startScanning() {\r\n    shouldRepeatScan = true;\r\n    isScanning = true;\r\n    if (rescanBtn) rescanBtn.hidden = true;\r\n    if (scanFrameEl) scanFrameEl.hidden = false;\r\n    if (scanInstructionsEl) scanInstructionsEl.hidden = false;\r\n    scan();\r\n  }\r\n\r\n  // Stop scanning\r\n  function stopScanning() {\r\n    shouldRepeatScan = false;\r\n    isScanning = false;\r\n    window.cancelAnimationFrame(rafId);\r\n    if (rescanBtn) rescanBtn.hidden = false;\r\n    if (scanFrameEl) scanFrameEl.hidden = true;\r\n    if (scanInstructionsEl) scanInstructionsEl.hidden = true;\r\n  }\r\n\r\n  // Main scan loop\r\n  async function scan() {\r\n    if (!isScanning) return;\r\n\r\n    try {\r\n      const videoEl = getVideoElement();\r\n      if (!videoEl || videoEl.readyState < 2) {\r\n        if (shouldRepeatScan) {\r\n          rafId = window.requestAnimationFrame(() => scan());\r\n        }\r\n        return;\r\n      }\r\n\r\n      const barcode = await detectBarcode(videoEl);\r\n      if (!barcode?.rawValue) throw new Error('No barcode value');\r\n\r\n      console.log(' Barcode detected:', barcode.rawValue);\r\n\r\n      // Stop scanning temporarily\r\n      stopScanning();\r\n\r\n      beep(200, 860, 0.03);\r\n      vibrate();\r\n\r\n      // Handle the barcode - add to fridge\r\n      await handleBarcodeDetected(barcode.rawValue);\r\n      return;\r\n    } catch {}\r\n\r\n    if (shouldRepeatScan) {\r\n      rafId = window.requestAnimationFrame(() => scan());\r\n    }\r\n  }\r\n\r\n  // Handle barcode detection - always show dialog, pre-fill if product exists\r\n  async function handleBarcodeDetected(barcode) {\r\n    // Check if product exists\r\n    const product = await getProductByBarcode(barcode);\r\n    // Always show dialog, pre-fill name if product exists\r\n    showProductDialog(barcode, product?.name || '');\r\n  }\r\n\r\n  // Show product dialog with optional pre-filled name\r\n  function showProductDialog(barcode, existingName = '') {\r\n    if (!productDialog) return;\r\n    productBarcodeInput.value = barcode;\r\n    productNameInput.value = existingName;\r\n    productQuantityInput.value = '1';\r\n    productDialog.showModal();\r\n    \r\n    if (existingName) {\r\n      // If name is pre-filled, focus on quantity instead\r\n      productQuantityInput.focus();\r\n      productQuantityInput.select();\r\n    } else {\r\n      productNameInput.focus();\r\n    }\r\n  }\r\n\r\n  // Handle product form submit\r\n  async function handleAddProduct() {\r\n    const barcode = productBarcodeInput?.value;\r\n    const name = productNameInput?.value?.trim();\r\n    const quantity = parseInt(productQuantityInput?.value) || 1;\r\n\r\n    if (!barcode || !name) return;\r\n\r\n    try {\r\n      // Check if product exists to see if we need to update\r\n      const existingProduct = await getProductByBarcode(barcode);\r\n      \r\n      if (existingProduct) {\r\n        // Product exists - update name if changed\r\n        if (existingProduct.name !== name) {\r\n          await updateProduct(barcode, { name });\r\n        }\r\n      } else {\r\n        // Create new product\r\n        await createProduct(barcode, name);\r\n      }\r\n      \r\n      // Add to fridge with quantity\r\n      await addToFridge(barcode, { name }, quantity);\r\n      productDialog?.close();\r\n      showToast(`${name} lagt til!`, 'success');\r\n    } catch (err) {\r\n      showToast('Feil: ' + err.message, 'danger');\r\n    }\r\n  }\r\n\r\n  // Event: Video starts playing\r\n  capturePhotoEl?.addEventListener('capture-photo:video-play', evt => {\r\n    capturePhotoVideoEl = evt.detail.video || capturePhotoEl.shadowRoot?.querySelector('video');\r\n    resizeScanFrame(capturePhotoVideoEl);\r\n    startScanning();\r\n\r\n    // Setup zoom if available\r\n    const trackSettings = capturePhotoEl.getTrackSettings();\r\n    const trackCapabilities = capturePhotoEl.getTrackCapabilities();\r\n    const zoomLevelEl = document.getElementById('zoomLevel');\r\n    const zoomControls = document.getElementById('zoomControls');\r\n\r\n    if (trackSettings?.zoom && trackCapabilities?.zoom) {\r\n      const minZoom = trackCapabilities.zoom.min || 1;\r\n      const maxZoom = trackCapabilities.zoom.max || 10;\r\n      let currentZoom = trackSettings.zoom || 1;\r\n\r\n      if (zoomControls) zoomControls.hidden = false;\r\n      if (zoomLevelEl) zoomLevelEl.textContent = currentZoom.toFixed(1);\r\n\r\n      zoomControls?.addEventListener('click', evt => {\r\n        const action = evt.target.closest('button')?.dataset.action;\r\n        if (action === 'zoom-in' && currentZoom < maxZoom) currentZoom += 0.5;\r\n        if (action === 'zoom-out' && currentZoom > minZoom) currentZoom -= 0.5;\r\n        if (zoomLevelEl) zoomLevelEl.textContent = currentZoom.toFixed(1);\r\n        capturePhotoEl.zoom = currentZoom;\r\n      });\r\n    }\r\n  });\r\n\r\n  // Event: Rescan button click\r\n  rescanBtn?.addEventListener('click', () => {\r\n    startScanning();\r\n  });\r\n\r\n  // Event: Settings\r\n  settingsBtn?.addEventListener('click', () => settingsDialog?.showModal());\r\n  \r\n  settingsDialog?.addEventListener('click', evt => {\r\n    if (evt.target === evt.currentTarget) settingsDialog.close();\r\n  });\r\n\r\n  settingsForm?.addEventListener('change', evt => {\r\n    const settings = {};\r\n    settingsForm.querySelectorAll('input[type=\"checkbox\"]').forEach(cb => {\r\n      settings[cb.name] = cb.checked;\r\n    });\r\n    setSettings(settings);\r\n  });\r\n\r\n  // Event: Product form\r\n  productForm?.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    await handleAddProduct();\r\n  });\r\n\r\n  document.getElementById('skipProductBtn')?.addEventListener('click', () => {\r\n    productDialog?.close();\r\n    // Resume scanning after closing dialog\r\n    startScanning();\r\n  });\r\n\r\n  productDialog?.addEventListener('click', evt => {\r\n    if (evt.target === evt.currentTarget) {\r\n      productDialog.close();\r\n      // Resume scanning after closing dialog\r\n      startScanning();\r\n    }\r\n  });\r\n\r\n  // Resume scanning after successful add\r\n  productDialog?.addEventListener('close', () => {\r\n    // Small delay before resuming scan\r\n    setTimeout(() => {\r\n      if (!productDialog.open) {\r\n        startScanning();\r\n      }\r\n    }, 500);\r\n  });\r\n\r\n}());\r\n","var e,t,i,s;function n(e,t,i){if(!t.has(e))throw new TypeError(\"attempted to \"+i+\" private field on non-instance\");return t.get(e)}function a(e,t){return t.get?t.get.call(e):t.value}function o(e,t){return a(e,n(e,t,\"get\"))}function r(e,t){if(t.has(e))throw new TypeError(\"Cannot initialize the same private elements twice on an object\")}function l(e,t,i){r(e,t),t.set(e,i)}function h(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError(\"attempted to set read only private field\");t.value=i}}function d(e,t,i){return h(e,n(e,t,\"set\"),i),i}function c(e,t,i){if(!t.has(e))throw new TypeError(\"attempted to get private field on non-instance\");return i}function u(e,t){r(e,t),t.add(e)}e={},t=\"ResizeObserverElement\",i=function(){return k},Object.defineProperty(e,t,{get:i,set:s,enumerable:!0,configurable:!0});const b=document.createElement(\"template\"),w=String.raw;b.innerHTML=w`\n  <style>:host { display: contents; }</style>\n  <slot></slot>\n`;var f=new WeakMap,p=new WeakMap,v=new WeakMap,m=new WeakSet,E=new WeakSet,g=new WeakMap,y=new WeakSet;class k extends HTMLElement{static get observedAttributes(){return[\"disabled\"]}attributeChangedCallback(e,t,i){\"disabled\"===e&&t!==i&&(this.disabled?c(this,E,z).call(this):c(this,m,C).call(this))}connectedCallback(){c(this,y,O).call(this,\"disabled\"),\"ResizeObserver\"in window&&(d(this,p,new ResizeObserver((e=>{this.dispatchEvent(new CustomEvent(\"resize-observer:resize\",{bubbles:!0,composed:!0,detail:{entries:e}}))}))),this.disabled||c(this,m,C).call(this),o(this,f).addEventListener(\"slotchange\",o(this,g)))}disconnectedCallback(){c(this,E,z).call(this),o(this,f).removeEventListener(\"slotchange\",o(this,g))}get disabled(){return this.hasAttribute(\"disabled\")}set disabled(e){e?this.setAttribute(\"disabled\",\"\"):this.removeAttribute(\"disabled\")}static defineCustomElement(e=\"resize-observer\"){\"undefined\"==typeof window||window.customElements.get(e)||window.customElements.define(e,k)}constructor(){super(),u(this,m),u(this,E),u(this,y),l(this,f,{writable:!0,value:void 0}),l(this,p,{writable:!0,value:void 0}),l(this,v,{writable:!0,value:void 0}),l(this,g,{writable:!0,value:()=>{this.disabled||c(this,m,C).call(this)}}),this.shadowRoot||(this.attachShadow({mode:\"open\"}),this.shadowRoot.appendChild(b.content.cloneNode(!0))),d(this,f,this.shadowRoot.querySelector(\"slot\")),d(this,p,null),d(this,v,[])}}function C(){o(this,f)&&o(this,p)&&(o(this,v).forEach((e=>o(this,p).unobserve(e))),d(this,v,[]),o(this,f).assignedElements().forEach((e=>{o(this,p).observe(e),o(this,v).push(e)})))}function z(){o(this,p)&&o(this,p).disconnect()}function O(e){if(Object.prototype.hasOwnProperty.call(this,e)){const t=this[e];delete this[e],this[e]=t}}k.defineCustomElement();export{k as ResizeObserverElement};\n//# sourceMappingURL=resize-observer-defined.js.map\n","export default function _classExtractFieldDescriptor(receiver, privateMap, action) {\n  if (!privateMap.has(receiver)) {\n    throw new TypeError(\"attempted to \" + action + \" private field on non-instance\");\n  }\n  return privateMap.get(receiver);\n}\n","export default function _classApplyDescriptorGet(receiver, descriptor) {\n  if (descriptor.get) {\n    return descriptor.get.call(receiver);\n  }\n  return descriptor.value;\n}\n","import classExtractFieldDescriptor from './_class_extract_field_descriptor.mjs';\nimport classApplyDescriptorGet from './_class_apply_descriptor_get.mjs';\n\nexport default function _classPrivateFieldGet(receiver, privateMap) {\n  var descriptor = classExtractFieldDescriptor(receiver, privateMap, \"get\");\n  return classApplyDescriptorGet(receiver, descriptor);\n}\n","export default function _checkPrivateRedeclaration(obj, privateCollection) {\n  if (privateCollection.has(obj)) {\n    throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n  }\n}\n","import _checkPrivateRedeclaration from \"./_check_private_redeclaration.mjs\";\n\nexport default function _classPrivateFieldInit(obj, privateMap, value) {\n  _checkPrivateRedeclaration(obj, privateMap);\n  privateMap.set(obj, value);\n}\n","export default function _classApplyDescriptorSet(receiver, descriptor, value) {\n  if (descriptor.set) {\n    descriptor.set.call(receiver, value);\n  } else {\n    if (!descriptor.writable) {\n      // This should only throw in strict mode, but class bodies are\n      // always strict and private fields can only be used inside\n      // class bodies.\n      throw new TypeError(\"attempted to set read only private field\");\n    }\n    descriptor.value = value;\n  }\n}\n","import classExtractFieldDescriptor from './_class_extract_field_descriptor.mjs';\nimport classApplyDescriptorSet from './_class_apply_descriptor_set.mjs';\n\nexport default function _classPrivateFieldSet(receiver, privateMap, value) {\n  var descriptor = classExtractFieldDescriptor(receiver, privateMap, \"set\");\n  classApplyDescriptorSet(receiver, descriptor, value);\n  return value;\n}\n","export default function _classPrivateMethodGet(receiver, privateSet, fn) {\n  if (!privateSet.has(receiver)) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n\n  return fn;\n}\n","import _checkPrivateRedeclaration from \"./_check_private_redeclaration.mjs\";\n\nexport default function _classPrivateMethodInit(obj, privateSet) {\n  _checkPrivateRedeclaration(obj, privateSet);\n  privateSet.add(obj);\n}\n","const template = document.createElement('template');\n\nconst html = String.raw;\n\ntemplate.innerHTML = html`\n  <style>:host { display: contents; }</style>\n  <slot></slot>\n`;\n\nclass ResizeObserverElement extends HTMLElement {\n  #slotEl;\n  #resizeObserver;\n  #observedElements;\n\n  constructor() {\n    super();\n\n    if (!this.shadowRoot) {\n      this.attachShadow({ mode: 'open' });\n      this.shadowRoot.appendChild(template.content.cloneNode(true));\n    }\n\n    this.#slotEl = this.shadowRoot.querySelector('slot');\n    this.#resizeObserver = null;\n    this.#observedElements = [];\n  }\n\n  static get observedAttributes() {\n    return ['disabled'];\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === 'disabled' && oldValue !== newValue) {\n      this.disabled ? this.#stopObserver() : this.#startObserver();\n    }\n  }\n\n  connectedCallback() {\n    this.#upgradeProperty('disabled');\n\n    if ('ResizeObserver' in window) {\n      this.#resizeObserver = new ResizeObserver(entries => {\n        this.dispatchEvent(new CustomEvent('resize-observer:resize', {\n          bubbles: true,\n          composed: true,\n          detail: { entries }\n        }));\n      });\n\n      if (!this.disabled) {\n        this.#startObserver();\n      }\n\n      this.#slotEl.addEventListener('slotchange', this.#onSlotChange);\n    }\n  }\n\n  disconnectedCallback() {\n    this.#stopObserver();\n    this.#slotEl.removeEventListener('slotchange', this.#onSlotChange);\n  }\n\n  get disabled() {\n    return this.hasAttribute('disabled');\n  }\n\n  set disabled(value) {\n    if (value) {\n      this.setAttribute('disabled', '');\n    } else {\n      this.removeAttribute('disabled');\n    }\n  }\n\n  #startObserver() {\n    if (!this.#slotEl || !this.#resizeObserver) {\n      return;\n    }\n\n    this.#observedElements.forEach(el => this.#resizeObserver.unobserve(el));\n    this.#observedElements = [];\n\n    this.#slotEl.assignedElements().forEach(el => {\n      this.#resizeObserver.observe(el);\n      this.#observedElements.push(el);\n    });\n  }\n\n  #stopObserver() {\n    this.#resizeObserver && this.#resizeObserver.disconnect();\n  }\n\n  #onSlotChange = () => {\n    if (!this.disabled) {\n      this.#startObserver();\n    }\n  };\n\n  #upgradeProperty(prop) {\n    if (Object.prototype.hasOwnProperty.call(this, prop)) {\n      const value = this[prop];\n      delete this[prop];\n      this[prop] = value;\n    }\n  }\n\n  static defineCustomElement(elementName = 'resize-observer') {\n    if (typeof window !== 'undefined' && !window.customElements.get(elementName)) {\n      window.customElements.define(elementName, ResizeObserverElement);\n    }\n  }\n}\n\nexport { ResizeObserverElement };\n","import { ResizeObserverElement } from './resize-observer.js';\n\nResizeObserverElement.defineCustomElement();\n\nexport { ResizeObserverElement };\n","Object.defineProperty({},\"CapturePhoto\",{get:function(){return n},set:void 0,enumerable:!0,configurable:!0});let t=(t,e,i)=>(Number.isNaN(e)&&(e=0),Number.isNaN(i)&&(i=0),Math.min(Math.max(t,Math.min(e,i)),Math.max(e,i))),e=\"capture-photo\",i=`\n  :host {\n    display: block;\n    box-sizing: border-box;\n  }\n\n  :host *,\n  :host *::before,\n  :host *::after {\n    box-sizing: inherit;\n  }\n\n  :host([hidden]),\n  [hidden],\n  ::slotted([hidden]) {\n    display: none;\n  }\n\n  video {\n    display: block;\n  }\n\n  #output:empty {\n    display: none;\n  }\n`,o=document.createElement(\"template\");o.innerHTML=`\n  <style>${i}</style>\n\n  <video part=\"video\" playsinline></video>\n\n  <canvas hidden></canvas>\n\n  <div part=\"actions-container\">\n    <slot name=\"capture-button\">\n      <button part=\"capture-button\" type=\"button\">\n        <slot name=\"capture-button-content\">Capture photo</slot>\n      </button>\n    </slot>\n\n    <slot name=\"facing-mode-button\" hidden>\n      <button part=\"facing-mode-button\" type=\"button\">\n        <slot name=\"facing-mode-button-content\">Toggle facing mode</slot>\n      </button>\n    </slot>\n\n    <slot name=\"actions\"></slot>\n  </div>\n\n  <slot></slot>\n\n  <div part=\"output-container\" id=\"output\"></div>\n`;class n extends HTMLElement{#t={};#e=null;#i=null;#o=null;#n=null;#a=null;#s=null;#r=null;#l=null;constructor(){super(),this.#t=this.getSupportedConstraints(),this.shadowRoot||this.attachShadow({mode:\"open\"}).appendChild(o.content.cloneNode(!0))}static get observedAttributes(){return[\"no-image\",\"facing-mode\",\"camera-resolution\",\"pan\",\"tilt\",\"zoom\"]}attributeChangedCallback(t,e,i){if(!this.isConnected)return;let o=this.getTrackCapabilities(),n=this.getTrackSettings();if(\"no-image\"===t&&e!==i&&this.#u(),\"facing-mode\"===t&&e!==i&&\"facingMode\"in this.#t){let t=[\"user\",\"environment\"].includes(this.facingMode||\"\");\"facingMode\"in n&&t&&(this.stopVideoStream(),this.startVideoStream())}if(\"camera-resolution\"===t&&e!==i&&\"string\"==typeof this.cameraResolution&&this.cameraResolution.trim().length>0){let[t=0,e=0]=this.cameraResolution.split(\"x\").map(t=>Number(t));if(t>0&&e>0&&\"width\"in o&&\"height\"in o){let i=!!(o.width?.min&&o.width?.max)&&t>=o?.width?.min&&t<=o?.width?.max,a=!!(o.height?.min&&o.height?.max)&&e>=o?.height?.min&&e<=o?.height?.max;\"width\"in n&&\"height\"in n&&i&&a&&(this.stopVideoStream(),this.startVideoStream())}}if(\"pan\"===t&&e!==i&&\"pan\"in this.#t){let t=!!(\"pan\"in o&&o.pan?.min&&o.pan?.max)&&this.pan>=o.pan.min&&this.pan<=o.pan.max;\"pan\"in n&&\"number\"==typeof this.pan&&t&&this.#h(\"pan\",this.pan)}if(\"tilt\"===t&&e!==i&&\"tilt\"in this.#t){let t=!!(\"tilt\"in o&&o.tilt?.min&&o.tilt?.max)&&this.tilt>=o.tilt.min&&this.tilt<=o.tilt.max;\"tilt\"in n&&\"number\"==typeof this.tilt&&t&&this.#h(\"tilt\",this.tilt)}if(\"zoom\"===t&&e!==i&&\"zoom\"in this.#t){let t=!!(\"zoom\"in o&&o.zoom?.min&&o.zoom?.max)&&this.zoom>=o.zoom.min&&this.zoom<=o.zoom.max;\"zoom\"in n&&\"number\"==typeof this.zoom&&t&&this.#h(\"zoom\",this.zoom)}}connectedCallback(){if(this.#d(\"autpoPlay\"),this.#d(\"noImage\"),this.#d(\"facingMode\"),this.#d(\"cameraResolution\"),this.#d(\"pan\"),this.#d(\"tilt\"),this.#d(\"zoom\"),this.#d(\"calculateFileSize\"),this.#i=this.shadowRoot?.querySelector(\"canvas\")||null,this.#o=this.shadowRoot?.getElementById(\"output\")||null,this.#n=this.shadowRoot?.querySelector(\"video\")||null,this.#a=this.shadowRoot?.querySelector('slot[name=\"capture-button\"]')||null,this.#s=this.#c(),this.#r=this.shadowRoot?.querySelector('slot[name=\"facing-mode-button\"]')||null,this.#l=this.#m(),this.#n?.addEventListener(\"loadedmetadata\",this.#p),this.#a?.addEventListener(\"slotchange\",this.#g),this.#s?.addEventListener(\"click\",this.#b),this.#r?.addEventListener(\"slotchange\",this.#f),this.#l?.addEventListener(\"click\",this.#v),!n.isSupported())return this.dispatchEvent(new CustomEvent(`${e}:error`,{bubbles:!0,composed:!0,detail:{error:{name:\"NotSupportedError\",message:\"Not supported\"}}}));this.autoPlay&&this.startVideoStream()}disconnectedCallback(){this.stopVideoStream(),this.#l?.removeEventListener(\"click\",this.#v),this.#s?.removeEventListener(\"click\",this.#b),this.#n?.removeEventListener(\"canplay\",this.#p),this.#a?.removeEventListener(\"slotchange\",this.#g),this.#r?.removeEventListener(\"slotchange\",this.#f)}get autoPlay(){return this.hasAttribute(\"auto-play\")}set autoPlay(t){this.toggleAttribute(\"auto-play\",!!t)}get noImage(){return this.hasAttribute(\"no-image\")}set noImage(t){this.toggleAttribute(\"no-image\",!!t)}get facingMode(){return this.getAttribute(\"facing-mode\")||\"user\"}set facingMode(t){this.setAttribute(\"facing-mode\",t)}get cameraResolution(){return this.getAttribute(\"camera-resolution\")||\"\"}set cameraResolution(t){this.setAttribute(\"camera-resolution\",t)}get pan(){return Number(this.getAttribute(\"pan\"))||0}set pan(t){this.setAttribute(\"pan\",null!=t?t.toString():t)}get tilt(){return Number(this.getAttribute(\"tilt\"))||0}set tilt(t){this.setAttribute(\"tilt\",null!=t?t.toString():t)}get zoom(){return Number(this.getAttribute(\"zoom\"))||1}set zoom(t){this.setAttribute(\"zoom\",null!=t?t.toString():t)}get loading(){return this.hasAttribute(\"loading\")}get calculateFileSize(){return this.hasAttribute(\"calculate-file-size\")}set calculateFileSize(t){this.toggleAttribute(\"calculate-file-size\",!!t)}#v=t=>{t.preventDefault(),this.loading||(this.facingMode=\"user\"!==this.facingMode&&this.facingMode?\"user\":\"environment\")};#b=t=>{t.preventDefault(),this.capture()};#p=t=>{let i=t.target;i.play().then(()=>{this.dispatchEvent(new CustomEvent(`${e}:video-play`,{bubbles:!0,composed:!0,detail:{video:i}}))}).catch(t=>{this.dispatchEvent(new CustomEvent(`${e}:error`,{bubbles:!0,composed:!0,detail:{error:t}}))}).finally(()=>{this.removeAttribute(\"loading\")})};#u(){this.#o&&Array.from(this.#o.childNodes).forEach(t=>t.remove())}#h(e,i){if(!this.#e||!e||!i)return;let[o]=this.#e.getVideoTracks(),n=this.getTrackCapabilities();e in this.getTrackSettings()&&o.applyConstraints({advanced:[{[e]:t(Number(i),n[e]?.min||1,n[e]?.max||1)}]})}#g=t=>{t.target?.name===\"capture-button\"&&(this.#s?.removeEventListener(\"click\",this.#b),this.#s=this.#c(),this.#s&&(this.#s.addEventListener(\"click\",this.#b),\"BUTTON\"===this.#s.nodeName||this.#s.hasAttribute(\"role\")||this.#s.setAttribute(\"role\",\"button\")))};#f=t=>{t.target?.name===\"facing-mode-button\"&&(this.#l?.removeEventListener(\"click\",this.#v),this.#l=this.#m(),this.#l&&(this.#l.addEventListener(\"click\",this.#v),\"BUTTON\"===this.#l.nodeName||this.#l.hasAttribute(\"role\")||this.#l.setAttribute(\"role\",\"button\")))};#m(){return this.#r&&this.#r.assignedElements({flatten:!0}).find(t=>\"BUTTON\"===t.nodeName||\"facing-mode-button\"===t.getAttribute(\"slot\"))||null}#c(){return this.#a&&this.#a.assignedElements({flatten:!0}).find(t=>\"BUTTON\"===t.nodeName||\"capture-button\"===t.getAttribute(\"slot\"))||null}#d(t){if(Object.prototype.hasOwnProperty.call(this,t)){let e=this[t];delete this[t],this[t]=e}}async startVideoStream(){if(!n.isSupported()||this.#e)return;this.setAttribute(\"loading\",\"\");let t={video:{facingMode:{ideal:this.facingMode||\"user\"},pan:!0,tilt:!0,zoom:!0},audio:!1};if(\"string\"==typeof this.cameraResolution&&this.cameraResolution.trim().length>0){let[e=0,i=0]=this.cameraResolution.split(\"x\").map(t=>Number(t));e>0&&i>0&&(t.video.width=e,t.video.height=i)}try{this.#e=await navigator.mediaDevices.getUserMedia(t),this.#n&&(this.#n.srcObject=this.#e),this.#h(\"pan\",this.pan),this.#h(\"tilt\",this.tilt),this.#h(\"zoom\",this.zoom);let e=this.getTrackSettings();\"facingMode\"in e&&this.#r&&(this.#r.hidden=!1)}catch(t){this.dispatchEvent(new CustomEvent(`${e}:error`,{bubbles:!0,composed:!0,detail:{error:t}}))}finally{this.removeAttribute(\"loading\")}}stopVideoStream(){if(!this.#n||!this.#e)return;let[t]=this.#e.getVideoTracks();t?.stop(),this.#n.srcObject=null,this.#e=null}async capture(){if(!this.loading&&this.#i&&this.#n)try{let t=this.#i.getContext(\"2d\"),i=this.#n.videoWidth,o=this.#n.videoHeight;this.#i.width=i,this.#i.height=o,t?.drawImage(this.#n,0,0,i,o);let n=this.#i.toDataURL(\"image/png\");if(\"string\"==typeof n&&n.includes(\"data:image\")){if(!this.noImage){let t=new Image;t.src=n,t.width=i,t.height=o,t.setAttribute(\"part\",\"output-image\"),this.#u(),this.#o?.appendChild(t)}let t={dataURI:n,width:i,height:o};if(this.calculateFileSize)try{let e=await fetch(n),i=(await e.blob()).size;i&&(t.size=i)}catch(t){}this.dispatchEvent(new CustomEvent(`${e}:success`,{bubbles:!0,composed:!0,detail:t}))}}catch(t){this.dispatchEvent(new CustomEvent(`${e}:error`,{bubbles:!0,composed:!0,detail:{error:t}}))}}getSupportedConstraints(){return n.isSupported()&&navigator.mediaDevices.getSupportedConstraints()||{}}getTrackCapabilities(){if(!this.#e)return{};let[t]=this.#e.getVideoTracks();return t&&\"function\"==typeof t.getCapabilities&&t.getCapabilities()||{}}getTrackSettings(){if(!this.#e)return{};let[t]=this.#e.getVideoTracks();return t&&\"function\"==typeof t.getSettings&&t.getSettings()||{}}static isSupported(){return!!navigator.mediaDevices?.getUserMedia}static defineCustomElement(t=e){\"undefined\"==typeof window||window.customElements.get(t)||window.customElements.define(t,n)}}n.defineCustomElement();export{n as CapturePhoto};\n//# sourceMappingURL=capture-photo-defined.js.map\n","function $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\nvar $c290816263f90981$exports = {};\n\n$parcel$export($c290816263f90981$exports, \"CapturePhoto\", function () { return $c290816263f90981$export$cc30a98fe3890794; });\n// @ts-check\n/**\n * Represents a value that may be of type T, or null.\n *\n * @template T\n * @typedef {T | null} Nullable\n */ /**\n * @typedef {Object} ExtendedMediaTrackCapabilities\n * @property {ULongRange} [width] - The width of the video track.\n * @property {ULongRange} [height] - The height of the video track.\n * @property {ULongRange} [pan] - The pan level of the camera.\n * @property {ULongRange} [tilt] - The tilt level of the camera.\n * @property {ULongRange} [zoom] - The zoom level of the camera.\n * @property {MediaTrackCapabilities} [nativeMediaTrackCapabilities] - The native track capabilities.\n */ /**\n * @typedef {Object} ExtendedMediaTrackConstraints\n * @property {MediaTrackConstraints & {pan: boolean, tilt: boolean, zoom: boolean}} video - The video constraints.\n * @property {MediaTrackConstraints | boolean} audio - The audio constraints.\n */ // @ts-check\n/**\n * Clamps number within the inclusive `min` and `max` bounds,\n * making sure it does not go beyond them on either side.\n * If `min` is greater than `max` the parameters are swapped to support inverted ranges.\n *\n * @param {number} value - The number to clamp.\n * @param {number} lower - The lower bound.\n * @param {number} upper - The upper bound.\n * @throws {TypeError} - If one or more of the arguments passed is not a number.\n * @returns {number} - The clamped number.\n * @example\n *\n * clamp(10, -5, 5);\n * // => 5\n *\n * clamp(-10, -5, 5);\n * // => -5\n *\n * clamp(-15, 0, 100);\n * // => 0\n *\n * clamp(120, 0, 100);\n * // => 100\n *\n * clamp(-5, NaN, 5); // If any of lower or upper bound are `NaN`, they will be converted to `0`.\n * // => 0\n *\n * clamp(120, 100, 0); // The order of lower and upper bounds is reversed (100 > 0)\n * // => 100\n */ const $02ad8beec419df62$export$7d15b64cf5a3a4c4 = (value, lower, upper)=>{\n    if (Number.isNaN(lower)) lower = 0;\n    if (Number.isNaN(upper)) upper = 0;\n    return Math.min(Math.max(value, Math.min(lower, upper)), Math.max(lower, upper));\n};\n\n\nconst $c290816263f90981$var$COMPONENT_NAME = \"capture-photo\";\nconst $c290816263f90981$var$styles = /* css */ `\n  :host {\n    display: block;\n    box-sizing: border-box;\n  }\n\n  :host *,\n  :host *::before,\n  :host *::after {\n    box-sizing: inherit;\n  }\n\n  :host([hidden]),\n  [hidden],\n  ::slotted([hidden]) {\n    display: none;\n  }\n\n  video {\n    display: block;\n  }\n\n  #output:empty {\n    display: none;\n  }\n`;\nconst $c290816263f90981$var$template = document.createElement(\"template\");\n$c290816263f90981$var$template.innerHTML = /* html */ `\n  <style>${$c290816263f90981$var$styles}</style>\n\n  <video part=\"video\" playsinline></video>\n\n  <canvas hidden></canvas>\n\n  <div part=\"actions-container\">\n    <slot name=\"capture-button\">\n      <button part=\"capture-button\" type=\"button\">\n        <slot name=\"capture-button-content\">Capture photo</slot>\n      </button>\n    </slot>\n\n    <slot name=\"facing-mode-button\" hidden>\n      <button part=\"facing-mode-button\" type=\"button\">\n        <slot name=\"facing-mode-button-content\">Toggle facing mode</slot>\n      </button>\n    </slot>\n\n    <slot name=\"actions\"></slot>\n  </div>\n\n  <slot></slot>\n\n  <div part=\"output-container\" id=\"output\"></div>\n`;\n/**\n * @summary A custom element that implements the MediaDevices.getUserMedia() method of the MediaDevices interface to capture a photo in the browser.\n * @documentation https://github.com/georapbox/capture-photo-element\n *\n * @tagname capture-photo This is the default tag name, unless overridden by the `defineCustomElement` method.\n * @extends HTMLElement\n *\n * @property {boolean} autoPlay - Whether or not to start the video stream automatically.\n * @property {boolean} noImage - Whether or not to show the captured image.\n * @property {string} facingMode - The facing mode of the camera.\n * @property {string} cameraResolution - The resolution of the camera.\n * @property {number} pan - The pan value of the camera.\n * @property {number} tilt - The tilt value of the camera.\n * @property {number} zoom - The zoom value of the camera.\n * @property {boolean} loading - Whether or not the video stream is loading.\n * @property {boolean} calculateFileSize - Whether or not to calculate the file size of the captured image.\n *\n * @atttribute {boolean} auto-play - Reflects the autoPlay property.\n * @atttribute {boolean} no-image - Reflects the noImage property.\n * @atttribute {string} facing-mode - Reflects the facingMode property.\n * @atttribute {string} camera-resolution - Reflects the cameraResolution property.\n * @atttribute {number} pan - Reflects the pan property.\n * @atttribute {number} tilt - Reflects the tilt property.\n * @atttribute {number} zoom - Reflects the zoom property.\n * @atttribute {boolean} loading - Reflects the loading property.\n * @atttribute {boolean} calculate-file-size - Reflects the calculateFileSize property.\n *\n * @slot capture-button - The capture button.\n * @slot capture-button-content - The capture button content.\n * @slot facing-mode-button - The facing mode button.\n * @slot facing-mode-button-content - The facing mode button content.\n * @slot actions - The actions container.\n * @slot - A default un-named slot to add content inside the component.\n *\n * @csspart video - The video element.\n * @csspart actions-container - The actions container.\n * @csspart capture-button - The capture button.\n * @csspart facing-mode-button - The facing mode button.\n * @csspart output-container - The output container.\n * @csspart output-image - The output image.\n *\n * @event capture-photo:video-play - Fires when the video stream is successfully playing.\n * @event capture-photo:success - Fires when the photo is successfully captured.\n * @event capture-photo:error - Fires when an error occurs.\n *\n * @method defineCustomElement - Static method. Defines the custom element with the given name.\n * @method isSupported - Static method. Checks if the MediaDevices.getUserMedia() method is supported.\n * @method startVideoStream - Instance method. Starts the video stream.\n * @method stopVideoStream - Instance method. Stops the video stream.\n * @method capture - Instance method. Captures a photo.\n * @method getSupportedConstraints - Instance method. Gets the supported constraints.\n * @method getTrackCapabilities - Instance method. Gets the track capabilities.\n * @method getTrackSettings - Instance method. Gets the track settings.\n */ class $c290816263f90981$export$cc30a98fe3890794 extends HTMLElement {\n    /** @type {MediaTrackSupportedConstraints | {}}*/ #supportedConstraints = {};\n    /** @type {Nullable<MediaStream>} */ #stream = null;\n    /** @type {Nullable<HTMLCanvasElement>} */ #canvasElement = null;\n    /** @type {Nullable<HTMLElement>} */ #outputElement = null;\n    /** @type {Nullable<HTMLVideoElement>} */ #videoElement = null;\n    /** @type {Nullable<HTMLSlotElement>} */ #captureButtonSlot = null;\n    /** @type {Nullable<HTMLButtonElement | Element>} */ #captureButton = null;\n    /** @type {Nullable<HTMLSlotElement>} */ #facingModeButtonSlot = null;\n    /** @type {Nullable<HTMLButtonElement | Element>} */ #facingModeButton = null;\n    constructor(){\n        super();\n        this.#supportedConstraints = this.getSupportedConstraints();\n        if (!this.shadowRoot) {\n            const shadowRoot = this.attachShadow({\n                mode: \"open\"\n            });\n            shadowRoot.appendChild($c290816263f90981$var$template.content.cloneNode(true));\n        }\n    }\n    static get observedAttributes() {\n        return [\n            \"no-image\",\n            \"facing-mode\",\n            \"camera-resolution\",\n            \"pan\",\n            \"tilt\",\n            \"zoom\"\n        ];\n    }\n    /**\n   * Lifecycle method that is called when attributes are changed, added, removed, or replaced.\n   *\n   * @param {string} name - The name of the attribute.\n   * @param {string} oldValue - The old value of the attribute.\n   * @param {string} newValue - The new value of the attribute.\n   */ attributeChangedCallback(name, oldValue, newValue) {\n        if (!this.isConnected) return;\n        /** @type {ExtendedMediaTrackCapabilities} */ const trackCapabilities = this.getTrackCapabilities();\n        const trackSettings = this.getTrackSettings();\n        if (name === \"no-image\" && oldValue !== newValue) this.#emptyOutputElement();\n        if (name === \"facing-mode\" && oldValue !== newValue && \"facingMode\" in this.#supportedConstraints) {\n            const isValidFacingMode = [\n                \"user\",\n                \"environment\"\n            ].includes(this.facingMode || \"\");\n            if (\"facingMode\" in trackSettings && isValidFacingMode) {\n                this.stopVideoStream();\n                this.startVideoStream();\n            }\n        }\n        if (name === \"camera-resolution\" && oldValue !== newValue) {\n            if (typeof this.cameraResolution === \"string\" && this.cameraResolution.trim().length > 0) {\n                const [width = 0, height = 0] = this.cameraResolution.split(\"x\").map((x)=>Number(x));\n                if (width > 0 && height > 0 && \"width\" in trackCapabilities && \"height\" in trackCapabilities) {\n                    const widthInAllowedRange = trackCapabilities.width?.min && trackCapabilities.width?.max ? width >= trackCapabilities?.width?.min && width <= trackCapabilities?.width?.max : false;\n                    const heightInAllowedRange = trackCapabilities.height?.min && trackCapabilities.height?.max ? height >= trackCapabilities?.height?.min && height <= trackCapabilities?.height?.max : false;\n                    if (\"width\" in trackSettings && \"height\" in trackSettings && widthInAllowedRange && heightInAllowedRange) {\n                        this.stopVideoStream();\n                        this.startVideoStream();\n                    }\n                }\n            }\n        }\n        if (name === \"pan\" && oldValue !== newValue && \"pan\" in this.#supportedConstraints) {\n            const panInAllowedRange = \"pan\" in trackCapabilities && trackCapabilities.pan?.min && trackCapabilities.pan?.max ? this.pan >= trackCapabilities.pan.min && this.pan <= trackCapabilities.pan.max : false;\n            if (\"pan\" in trackSettings && typeof this.pan === \"number\" && panInAllowedRange) this.#applyPTZ(\"pan\", this.pan);\n        }\n        if (name === \"tilt\" && oldValue !== newValue && \"tilt\" in this.#supportedConstraints) {\n            const tiltInAllowedRange = \"tilt\" in trackCapabilities && trackCapabilities.tilt?.min && trackCapabilities.tilt?.max ? this.tilt >= trackCapabilities.tilt.min && this.tilt <= trackCapabilities.tilt.max : false;\n            if (\"tilt\" in trackSettings && typeof this.tilt === \"number\" && tiltInAllowedRange) this.#applyPTZ(\"tilt\", this.tilt);\n        }\n        if (name === \"zoom\" && oldValue !== newValue && \"zoom\" in this.#supportedConstraints) {\n            const zoomInAllowedRange = \"zoom\" in trackCapabilities && trackCapabilities.zoom?.min && trackCapabilities.zoom?.max ? this.zoom >= trackCapabilities.zoom.min && this.zoom <= trackCapabilities.zoom.max : false;\n            if (\"zoom\" in trackSettings && typeof this.zoom === \"number\" && zoomInAllowedRange) this.#applyPTZ(\"zoom\", this.zoom);\n        }\n    }\n    /**\n   * Lifecycle method that is called when the element is added to the DOM.\n   */ connectedCallback() {\n        this.#upgradeProperty(\"autpoPlay\");\n        this.#upgradeProperty(\"noImage\");\n        this.#upgradeProperty(\"facingMode\");\n        this.#upgradeProperty(\"cameraResolution\");\n        this.#upgradeProperty(\"pan\");\n        this.#upgradeProperty(\"tilt\");\n        this.#upgradeProperty(\"zoom\");\n        this.#upgradeProperty(\"calculateFileSize\");\n        this.#canvasElement = this.shadowRoot?.querySelector(\"canvas\") || null;\n        this.#outputElement = this.shadowRoot?.getElementById(\"output\") || null;\n        this.#videoElement = this.shadowRoot?.querySelector(\"video\") || null;\n        this.#captureButtonSlot = this.shadowRoot?.querySelector('slot[name=\"capture-button\"]') || null;\n        this.#captureButton = this.#getCaptureButton();\n        this.#facingModeButtonSlot = this.shadowRoot?.querySelector('slot[name=\"facing-mode-button\"]') || null;\n        this.#facingModeButton = this.#getFacingModeButton();\n        this.#videoElement?.addEventListener(\"loadedmetadata\", this.#onVideoLoadedMetaData);\n        this.#captureButtonSlot?.addEventListener(\"slotchange\", this.#onCaptureButtonSlotChange);\n        this.#captureButton?.addEventListener(\"click\", this.#onCapturePhotoButtonClick);\n        this.#facingModeButtonSlot?.addEventListener(\"slotchange\", this.#onFacingModeButtonSlotChange);\n        this.#facingModeButton?.addEventListener(\"click\", this.#onFacingModeButtonClick);\n        if (!$c290816263f90981$export$cc30a98fe3890794.isSupported()) return this.dispatchEvent(new CustomEvent(`${$c290816263f90981$var$COMPONENT_NAME}:error`, {\n            bubbles: true,\n            composed: true,\n            detail: {\n                error: {\n                    name: \"NotSupportedError\",\n                    message: \"Not supported\"\n                }\n            }\n        }));\n        if (this.autoPlay) this.startVideoStream();\n    }\n    /**\n   * Lifecycle method that is called when the element is removed from the DOM.\n   */ disconnectedCallback() {\n        this.stopVideoStream();\n        this.#facingModeButton?.removeEventListener(\"click\", this.#onFacingModeButtonClick);\n        this.#captureButton?.removeEventListener(\"click\", this.#onCapturePhotoButtonClick);\n        this.#videoElement?.removeEventListener(\"canplay\", this.#onVideoLoadedMetaData);\n        this.#captureButtonSlot?.removeEventListener(\"slotchange\", this.#onCaptureButtonSlotChange);\n        this.#facingModeButtonSlot?.removeEventListener(\"slotchange\", this.#onFacingModeButtonSlotChange);\n    }\n    /**\n   * @type {boolean} autoPlay - Whether or not to start the video stream automatically.\n   * @attribute auto-play - Reflects the autoPlay attribute.\n   */ get autoPlay() {\n        return this.hasAttribute(\"auto-play\");\n    }\n    set autoPlay(value) {\n        this.toggleAttribute(\"auto-play\", !!value);\n    }\n    /**\n   * @type {boolean} noImage - Whether or not to show the captured image.\n   * @attribute no-image - Reflects the noImage attribute.\n   */ get noImage() {\n        return this.hasAttribute(\"no-image\");\n    }\n    set noImage(value) {\n        this.toggleAttribute(\"no-image\", !!value);\n    }\n    /**\n   * @type {string} facingMode - The facing mode of the camera.\n   * @attribute facing-mode - Reflects the facingMode attribute.\n   */ get facingMode() {\n        return this.getAttribute(\"facing-mode\") || \"user\";\n    }\n    set facingMode(value) {\n        this.setAttribute(\"facing-mode\", value);\n    }\n    /**\n   * @type {string} cameraResolution - The resolution of the camera.\n   * @attribute camera-resolution - Reflects the cameraResolution attribute.\n   */ get cameraResolution() {\n        return this.getAttribute(\"camera-resolution\") || \"\";\n    }\n    set cameraResolution(value) {\n        this.setAttribute(\"camera-resolution\", value);\n    }\n    /**\n   * @type {number} pan - The pan value of the camera.\n   * @attribute pan - Reflects the pan attribute.\n   */ get pan() {\n        return Number(this.getAttribute(\"pan\")) || 0;\n    }\n    set pan(value) {\n        this.setAttribute(\"pan\", value != null ? value.toString() : value);\n    }\n    /**\n   * @type {number} tilt - The tilt value of the camera.\n   * @attribute tilt - Reflects the tilt attribute.\n   */ get tilt() {\n        return Number(this.getAttribute(\"tilt\")) || 0;\n    }\n    set tilt(value) {\n        this.setAttribute(\"tilt\", value != null ? value.toString() : value);\n    }\n    /**\n   * @type {number} zoom - The zoom value of the camera.\n   * @attribute zoom - Reflects the zoom attribute.\n   */ get zoom() {\n        return Number(this.getAttribute(\"zoom\")) || 1;\n    }\n    set zoom(value) {\n        this.setAttribute(\"zoom\", value != null ? value.toString() : value);\n    }\n    /**\n   * @type {boolean} loading - Whether or not the video stream is loading.\n   * @attribute loading - Reflects the loading attribute.\n   */ get loading() {\n        return this.hasAttribute(\"loading\");\n    }\n    /**\n   * @type {boolean} calculateFileSize - Whether or not to calculate the file size of the captured image.\n   * @attribute calculate-file-size - Reflects the calculateFileSize attribute.\n   */ get calculateFileSize() {\n        return this.hasAttribute(\"calculate-file-size\");\n    }\n    set calculateFileSize(value) {\n        this.toggleAttribute(\"calculate-file-size\", !!value);\n    }\n    /**\n   * Handles the click event of the facing mode button.\n   *\n   * @param {*} evt - The click event.\n   */ #onFacingModeButtonClick = (evt)=>{\n        evt.preventDefault();\n        if (this.loading) return;\n        this.facingMode = this.facingMode === \"user\" || !this.facingMode ? \"environment\" : \"user\";\n    };\n    /**\n   * Handles the click event of the capture button.\n   *\n   * @param {*} evt - The click event.\n   */ #onCapturePhotoButtonClick = (evt)=>{\n        evt.preventDefault();\n        this.capture();\n    };\n    /**\n   * Handles the loadedmetadata event of the video element.\n   *\n   * @param {*} evt - The loadedmetadata event.\n   */ #onVideoLoadedMetaData = (evt)=>{\n        const video = evt.target;\n        video.play().then(()=>{\n            this.dispatchEvent(new CustomEvent(`${$c290816263f90981$var$COMPONENT_NAME}:video-play`, {\n                bubbles: true,\n                composed: true,\n                detail: {\n                    video: video\n                }\n            }));\n        }).catch(/** @param {Error} error */ (error)=>{\n            this.dispatchEvent(new CustomEvent(`${$c290816263f90981$var$COMPONENT_NAME}:error`, {\n                bubbles: true,\n                composed: true,\n                detail: {\n                    error: error\n                }\n            }));\n        }).finally(()=>{\n            this.removeAttribute(\"loading\");\n        });\n    };\n    /**\n   * Removes all child nodes from the output element.\n   */ #emptyOutputElement() {\n        if (!this.#outputElement) return;\n        Array.from(this.#outputElement.childNodes).forEach((node)=>node.remove());\n    }\n    /**\n   * Applies the pan, tilt or zoom constraint.\n   *\n   * @param {'pan' | 'tilt' | 'zoom'} constraintName - The name of the constraint.\n   * @param {number} constraintValue - The value of the constraint.\n   */ #applyPTZ(constraintName, constraintValue) {\n        if (!this.#stream || !constraintName || !constraintValue) return;\n        const [track] = this.#stream.getVideoTracks();\n        /** @type {ExtendedMediaTrackCapabilities} */ const trackCapabilities = this.getTrackCapabilities();\n        const trackSettings = this.getTrackSettings();\n        if (constraintName in trackSettings) track.applyConstraints({\n            advanced: [\n                {\n                    [constraintName]: (0, $02ad8beec419df62$export$7d15b64cf5a3a4c4)(Number(constraintValue), trackCapabilities[constraintName]?.min || 1, trackCapabilities[constraintName]?.max || 1)\n                }\n            ]\n        });\n    }\n    /**\n   * Handles the slotchange event of the capture button slot.\n   *\n   * @param {*} evt - The slotchange event.\n   */ #onCaptureButtonSlotChange = (evt)=>{\n        if (evt.target?.name === \"capture-button\") {\n            this.#captureButton?.removeEventListener(\"click\", this.#onCapturePhotoButtonClick);\n            this.#captureButton = this.#getCaptureButton();\n            if (this.#captureButton) {\n                this.#captureButton.addEventListener(\"click\", this.#onCapturePhotoButtonClick);\n                if (this.#captureButton.nodeName !== \"BUTTON\" && !this.#captureButton.hasAttribute(\"role\")) this.#captureButton.setAttribute(\"role\", \"button\");\n            }\n        }\n    };\n    /**\n   * Handles the slotchange event of the facing mode button slot.\n   *\n   * @param {*} evt - The slotchange event.\n   */ #onFacingModeButtonSlotChange = (evt)=>{\n        if (evt.target?.name === \"facing-mode-button\") {\n            this.#facingModeButton?.removeEventListener(\"click\", this.#onFacingModeButtonClick);\n            this.#facingModeButton = this.#getFacingModeButton();\n            if (this.#facingModeButton) {\n                this.#facingModeButton.addEventListener(\"click\", this.#onFacingModeButtonClick);\n                if (this.#facingModeButton.nodeName !== \"BUTTON\" && !this.#facingModeButton.hasAttribute(\"role\")) this.#facingModeButton.setAttribute(\"role\", \"button\");\n            }\n        }\n    };\n    /**\n   * Returns the facing mode button.\n   *\n   * @returns {Nullable<HTMLButtonElement | Element>}\n   */ #getFacingModeButton() {\n        if (!this.#facingModeButtonSlot) return null;\n        return this.#facingModeButtonSlot.assignedElements({\n            flatten: true\n        }).find((el)=>{\n            return el.nodeName === \"BUTTON\" || el.getAttribute(\"slot\") === \"facing-mode-button\";\n        }) || null;\n    }\n    /**\n   * Returns the capture button.\n   *\n   * @returns {Nullable<HTMLButtonElement | Element>}\n   */ #getCaptureButton() {\n        if (!this.#captureButtonSlot) return null;\n        return this.#captureButtonSlot.assignedElements({\n            flatten: true\n        }).find((el)=>{\n            return el.nodeName === \"BUTTON\" || el.getAttribute(\"slot\") === \"capture-button\";\n        }) || null;\n    }\n    /**\n   * This is to safe guard against cases where, for instance, a framework may have added the element to the page and\n   * set a value on one of its properties, but lazy loaded its definition. Without this guard, the upgraded element would\n   * miss that property and the instance property would prevent the class property setter from ever being called.\n   *\n   * https://developers.google.com/web/fundamentals/web-components/best-practices#lazy-properties\n   *\n   * @param {'autpoPlay' | 'noImage' | 'facingMode' | 'cameraResolution' | 'pan' | 'tilt' | 'zoom' | 'calculateFileSize'} prop\n   */ #upgradeProperty(prop) {\n        /** @type {any} */ const instance = this;\n        if (Object.prototype.hasOwnProperty.call(instance, prop)) {\n            const value = instance[prop];\n            delete instance[prop];\n            instance[prop] = value;\n        }\n    }\n    /**\n   * Starts the video stream.\n   *\n   * @returns Promise<void>\n   */ async startVideoStream() {\n        if (!$c290816263f90981$export$cc30a98fe3890794.isSupported() || this.#stream) return;\n        this.setAttribute(\"loading\", \"\");\n        /** @type {ExtendedMediaTrackConstraints} */ const constraints = {\n            video: {\n                facingMode: {\n                    ideal: this.facingMode || \"user\"\n                },\n                pan: true,\n                tilt: true,\n                zoom: true\n            },\n            audio: false\n        };\n        if (typeof this.cameraResolution === \"string\" && this.cameraResolution.trim().length > 0) {\n            const [width = 0, height = 0] = this.cameraResolution.split(\"x\").map((x)=>Number(x));\n            if (width > 0 && height > 0) {\n                constraints.video.width = width;\n                constraints.video.height = height;\n            }\n        }\n        try {\n            this.#stream = await navigator.mediaDevices.getUserMedia(constraints);\n            if (this.#videoElement) this.#videoElement.srcObject = this.#stream;\n            this.#applyPTZ(\"pan\", this.pan);\n            this.#applyPTZ(\"tilt\", this.tilt);\n            this.#applyPTZ(\"zoom\", this.zoom);\n            const trackSettings = this.getTrackSettings();\n            if (\"facingMode\" in trackSettings && this.#facingModeButtonSlot) this.#facingModeButtonSlot.hidden = false;\n        } catch (error) {\n            this.dispatchEvent(new CustomEvent(`${$c290816263f90981$var$COMPONENT_NAME}:error`, {\n                bubbles: true,\n                composed: true,\n                detail: {\n                    error: error\n                }\n            }));\n        } finally{\n            this.removeAttribute(\"loading\");\n        }\n    }\n    /**\n   * Stops the video stream.\n   */ stopVideoStream() {\n        if (!this.#videoElement || !this.#stream) return;\n        const [track] = this.#stream.getVideoTracks();\n        track?.stop();\n        this.#videoElement.srcObject = null;\n        this.#stream = null;\n    }\n    /**\n   * Captures a photo using the element's properties.\n   *\n   * @returns Promise<void>\n   */ async capture() {\n        if (this.loading || !this.#canvasElement || !this.#videoElement) return;\n        try {\n            const ctx = this.#canvasElement.getContext(\"2d\");\n            const width = this.#videoElement.videoWidth;\n            const height = this.#videoElement.videoHeight;\n            this.#canvasElement.width = width;\n            this.#canvasElement.height = height;\n            ctx?.drawImage(this.#videoElement, 0, 0, width, height);\n            const dataURI = this.#canvasElement.toDataURL(\"image/png\");\n            if (typeof dataURI === \"string\" && dataURI.includes(\"data:image\")) {\n                if (!this.noImage) {\n                    const image = new Image();\n                    image.src = dataURI;\n                    image.width = width;\n                    image.height = height;\n                    image.setAttribute(\"part\", \"output-image\");\n                    this.#emptyOutputElement();\n                    this.#outputElement?.appendChild(image);\n                }\n                /** @type {{ dataURI: string, width: number, height: number, size?: number }} */ const eventDetail = {\n                    dataURI: dataURI,\n                    width: width,\n                    height: height\n                };\n                if (this.calculateFileSize) try {\n                    const file = await fetch(dataURI);\n                    const blob = await file.blob();\n                    const size = blob.size;\n                    if (size) eventDetail.size = size;\n                } catch (err) {\n                // Fail silently...\n                }\n                this.dispatchEvent(new CustomEvent(`${$c290816263f90981$var$COMPONENT_NAME}:success`, {\n                    bubbles: true,\n                    composed: true,\n                    detail: eventDetail\n                }));\n            }\n        } catch (error) {\n            this.dispatchEvent(new CustomEvent(`${$c290816263f90981$var$COMPONENT_NAME}:error`, {\n                bubbles: true,\n                composed: true,\n                detail: {\n                    error: error\n                }\n            }));\n        }\n    }\n    /**\n   * Returns an object based on the `MediaTrackSupportedConstraints` dictionary,\n   * whose member fields each specify one ofthe constrainable properties the user agent understands.\n   *\n   * @see https://developer.mozilla.org/docs/Web/API/MediaDevices/getSupportedConstraints\n   * @returns {MediaTrackSupportedConstraints | {}}\n   */ getSupportedConstraints() {\n        if (!$c290816263f90981$export$cc30a98fe3890794.isSupported()) return {};\n        return navigator.mediaDevices.getSupportedConstraints() || {};\n    }\n    /**\n   * Returns a `MediaTrackCapabilities` object which specifies the values or range of values\n   * which each constrainable property, based upon the platform and user agent.\n   *\n   * @see https://developer.mozilla.org/docs/Web/API/MediaStreamTrack/getCapabilities\n   * @returns {MediaTrackCapabilities | {}}\n   */ getTrackCapabilities() {\n        if (!this.#stream) return {};\n        const [track] = this.#stream.getVideoTracks();\n        if (track && typeof track.getCapabilities === \"function\") return track.getCapabilities() || {};\n        return {};\n    }\n    /**\n   * Returns a `MediaTrackSettings` object containing the current values of each of\n   * the constrainable properties for the current MediaStreamTrack.\n   *\n   * @see https://developer.mozilla.org/docs/Web/API/MediaStreamTrack/getSettings\n   * @returns {MediaTrackSettings | {}}\n   */ getTrackSettings() {\n        if (!this.#stream) return {};\n        const [track] = this.#stream.getVideoTracks();\n        if (track && typeof track.getSettings === \"function\") return track.getSettings() || {};\n        return {};\n    }\n    /**\n   * Checks if the `MediaDevices.getUserMedia()` method is supported.\n   *\n   * @returns {boolean}\n   */ static isSupported() {\n        return Boolean(navigator.mediaDevices?.getUserMedia);\n    }\n    /**\n   * Defines a custom element with the given name.\n   * The name must contain a dash (-).\n   *\n   * @param {string} [elementName='capture-photo'] - The name of the custom element.\n   * @example\n   *\n   * CapturePhoto.defineCustomElement('my-capture-photo');\n   */ static defineCustomElement(elementName = $c290816263f90981$var$COMPONENT_NAME) {\n        if (typeof window !== \"undefined\" && !window.customElements.get(elementName)) window.customElements.define(elementName, $c290816263f90981$export$cc30a98fe3890794);\n    }\n}\n\n\n(0, $c290816263f90981$export$cc30a98fe3890794).defineCustomElement();\n\n\nexport {$c290816263f90981$export$cc30a98fe3890794 as CapturePhoto};\n//# sourceMappingURL=capture-photo-defined.js.map\n","import { CapturePhoto } from './capture-photo.js';\n\nCapturePhoto.defineCustomElement();\n\nexport { CapturePhoto };\n","// @ts-check\n\n/**\n * Represents a value that may be of type T, or null.\n *\n * @template T\n * @typedef {T | null} Nullable\n */\n\n/**\n * @typedef {Object} ExtendedMediaTrackCapabilities\n * @property {ULongRange} [width] - The width of the video track.\n * @property {ULongRange} [height] - The height of the video track.\n * @property {ULongRange} [pan] - The pan level of the camera.\n * @property {ULongRange} [tilt] - The tilt level of the camera.\n * @property {ULongRange} [zoom] - The zoom level of the camera.\n * @property {MediaTrackCapabilities} [nativeMediaTrackCapabilities] - The native track capabilities.\n */\n\n/**\n * @typedef {Object} ExtendedMediaTrackConstraints\n * @property {MediaTrackConstraints & {pan: boolean, tilt: boolean, zoom: boolean}} video - The video constraints.\n * @property {MediaTrackConstraints | boolean} audio - The audio constraints.\n */\n\nimport { clamp } from './utils/clamp.js';\n\nconst COMPONENT_NAME = 'capture-photo';\n\nconst styles = /* css */`\n  :host {\n    display: block;\n    box-sizing: border-box;\n  }\n\n  :host *,\n  :host *::before,\n  :host *::after {\n    box-sizing: inherit;\n  }\n\n  :host([hidden]),\n  [hidden],\n  ::slotted([hidden]) {\n    display: none;\n  }\n\n  video {\n    display: block;\n  }\n\n  #output:empty {\n    display: none;\n  }\n`;\n\nconst template = document.createElement('template');\n\ntemplate.innerHTML = /* html */`\n  <style>${styles}</style>\n\n  <video part=\"video\" playsinline></video>\n\n  <canvas hidden></canvas>\n\n  <div part=\"actions-container\">\n    <slot name=\"capture-button\">\n      <button part=\"capture-button\" type=\"button\">\n        <slot name=\"capture-button-content\">Capture photo</slot>\n      </button>\n    </slot>\n\n    <slot name=\"facing-mode-button\" hidden>\n      <button part=\"facing-mode-button\" type=\"button\">\n        <slot name=\"facing-mode-button-content\">Toggle facing mode</slot>\n      </button>\n    </slot>\n\n    <slot name=\"actions\"></slot>\n  </div>\n\n  <slot></slot>\n\n  <div part=\"output-container\" id=\"output\"></div>\n`;\n\n/**\n * @summary A custom element that implements the MediaDevices.getUserMedia() method of the MediaDevices interface to capture a photo in the browser.\n * @documentation https://github.com/georapbox/capture-photo-element\n *\n * @tagname capture-photo This is the default tag name, unless overridden by the `defineCustomElement` method.\n * @extends HTMLElement\n *\n * @property {boolean} autoPlay - Whether or not to start the video stream automatically.\n * @property {boolean} noImage - Whether or not to show the captured image.\n * @property {string} facingMode - The facing mode of the camera.\n * @property {string} cameraResolution - The resolution of the camera.\n * @property {number} pan - The pan value of the camera.\n * @property {number} tilt - The tilt value of the camera.\n * @property {number} zoom - The zoom value of the camera.\n * @property {boolean} loading - Whether or not the video stream is loading.\n * @property {boolean} calculateFileSize - Whether or not to calculate the file size of the captured image.\n *\n * @atttribute {boolean} auto-play - Reflects the autoPlay property.\n * @atttribute {boolean} no-image - Reflects the noImage property.\n * @atttribute {string} facing-mode - Reflects the facingMode property.\n * @atttribute {string} camera-resolution - Reflects the cameraResolution property.\n * @atttribute {number} pan - Reflects the pan property.\n * @atttribute {number} tilt - Reflects the tilt property.\n * @atttribute {number} zoom - Reflects the zoom property.\n * @atttribute {boolean} loading - Reflects the loading property.\n * @atttribute {boolean} calculate-file-size - Reflects the calculateFileSize property.\n *\n * @slot capture-button - The capture button.\n * @slot capture-button-content - The capture button content.\n * @slot facing-mode-button - The facing mode button.\n * @slot facing-mode-button-content - The facing mode button content.\n * @slot actions - The actions container.\n * @slot - A default un-named slot to add content inside the component.\n *\n * @csspart video - The video element.\n * @csspart actions-container - The actions container.\n * @csspart capture-button - The capture button.\n * @csspart facing-mode-button - The facing mode button.\n * @csspart output-container - The output container.\n * @csspart output-image - The output image.\n *\n * @event capture-photo:video-play - Fires when the video stream is successfully playing.\n * @event capture-photo:success - Fires when the photo is successfully captured.\n * @event capture-photo:error - Fires when an error occurs.\n *\n * @method defineCustomElement - Static method. Defines the custom element with the given name.\n * @method isSupported - Static method. Checks if the MediaDevices.getUserMedia() method is supported.\n * @method startVideoStream - Instance method. Starts the video stream.\n * @method stopVideoStream - Instance method. Stops the video stream.\n * @method capture - Instance method. Captures a photo.\n * @method getSupportedConstraints - Instance method. Gets the supported constraints.\n * @method getTrackCapabilities - Instance method. Gets the track capabilities.\n * @method getTrackSettings - Instance method. Gets the track settings.\n */\nclass CapturePhoto extends HTMLElement {\n  /** @type {MediaTrackSupportedConstraints | {}}*/\n  #supportedConstraints = {};\n\n  /** @type {Nullable<MediaStream>} */\n  #stream = null;\n\n  /** @type {Nullable<HTMLCanvasElement>} */\n  #canvasElement = null;\n\n  /** @type {Nullable<HTMLElement>} */\n  #outputElement = null;\n\n  /** @type {Nullable<HTMLVideoElement>} */\n  #videoElement = null;\n\n  /** @type {Nullable<HTMLSlotElement>} */\n  #captureButtonSlot = null;\n\n  /** @type {Nullable<HTMLButtonElement | Element>} */\n  #captureButton = null;\n\n  /** @type {Nullable<HTMLSlotElement>} */\n  #facingModeButtonSlot = null;\n\n  /** @type {Nullable<HTMLButtonElement | Element>} */\n  #facingModeButton = null;\n\n  constructor() {\n    super();\n\n    this.#supportedConstraints = this.getSupportedConstraints();\n\n    if (!this.shadowRoot) {\n      const shadowRoot = this.attachShadow({ mode: 'open' });\n      shadowRoot.appendChild(template.content.cloneNode(true));\n    }\n  }\n\n  static get observedAttributes() {\n    return ['no-image', 'facing-mode', 'camera-resolution', 'pan', 'tilt', 'zoom'];\n  }\n\n  /**\n   * Lifecycle method that is called when attributes are changed, added, removed, or replaced.\n   *\n   * @param {string} name - The name of the attribute.\n   * @param {string} oldValue - The old value of the attribute.\n   * @param {string} newValue - The new value of the attribute.\n   */\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (!this.isConnected) {\n      return;\n    }\n\n    /** @type {ExtendedMediaTrackCapabilities} */\n    const trackCapabilities = this.getTrackCapabilities();\n    const trackSettings = this.getTrackSettings();\n\n    if (name === 'no-image' && oldValue !== newValue) {\n      this.#emptyOutputElement();\n    }\n\n    if (name === 'facing-mode' && oldValue !== newValue && 'facingMode' in this.#supportedConstraints) {\n      const isValidFacingMode = ['user', 'environment'].includes(this.facingMode || '');\n\n      if ('facingMode' in trackSettings && isValidFacingMode) {\n        this.stopVideoStream();\n        this.startVideoStream();\n      }\n    }\n\n    if (name === 'camera-resolution' && oldValue !== newValue) {\n      if (typeof this.cameraResolution === 'string' && this.cameraResolution.trim().length > 0) {\n        const [width = 0, height = 0] = this.cameraResolution.split('x').map(x => Number(x));\n\n        if (width > 0 && height > 0 && 'width' in trackCapabilities && 'height' in trackCapabilities) {\n          const widthInAllowedRange = trackCapabilities.width?.min && trackCapabilities.width?.max\n            ? width >= trackCapabilities?.width?.min && width <= trackCapabilities?.width?.max\n            : false;\n\n          const heightInAllowedRange = trackCapabilities.height?.min && trackCapabilities.height?.max\n            ? height >= trackCapabilities?.height?.min && height <= trackCapabilities?.height?.max\n            : false;\n\n          if ('width' in trackSettings && 'height' in trackSettings && widthInAllowedRange && heightInAllowedRange) {\n            this.stopVideoStream();\n            this.startVideoStream();\n          }\n        }\n      }\n    }\n\n    if (name === 'pan' && oldValue !== newValue && 'pan' in this.#supportedConstraints) {\n      const panInAllowedRange = 'pan' in trackCapabilities && trackCapabilities.pan?.min && trackCapabilities.pan?.max\n        ? this.pan >= trackCapabilities.pan.min && this.pan <= trackCapabilities.pan.max\n        : false;\n\n      if ('pan' in trackSettings && typeof this.pan === 'number' && panInAllowedRange) {\n        this.#applyPTZ('pan', this.pan);\n      }\n    }\n\n    if (name === 'tilt' && oldValue !== newValue && 'tilt' in this.#supportedConstraints) {\n      const tiltInAllowedRange = 'tilt' in trackCapabilities && trackCapabilities.tilt?.min && trackCapabilities.tilt?.max\n        ? this.tilt >= trackCapabilities.tilt.min && this.tilt <= trackCapabilities.tilt.max\n        : false;\n\n      if ('tilt' in trackSettings && typeof this.tilt === 'number' && tiltInAllowedRange) {\n        this.#applyPTZ('tilt', this.tilt);\n      }\n    }\n\n    if (name === 'zoom' && oldValue !== newValue && 'zoom' in this.#supportedConstraints) {\n      const zoomInAllowedRange = 'zoom' in trackCapabilities && trackCapabilities.zoom?.min && trackCapabilities.zoom?.max\n        ? this.zoom >= trackCapabilities.zoom.min && this.zoom <= trackCapabilities.zoom.max\n        : false;\n\n      if ('zoom' in trackSettings && typeof this.zoom === 'number' && zoomInAllowedRange) {\n        this.#applyPTZ('zoom', this.zoom);\n      }\n    }\n  }\n\n  /**\n   * Lifecycle method that is called when the element is added to the DOM.\n   */\n  connectedCallback() {\n    this.#upgradeProperty('autpoPlay');\n    this.#upgradeProperty('noImage');\n    this.#upgradeProperty('facingMode');\n    this.#upgradeProperty('cameraResolution');\n    this.#upgradeProperty('pan');\n    this.#upgradeProperty('tilt');\n    this.#upgradeProperty('zoom');\n    this.#upgradeProperty('calculateFileSize');\n\n    this.#canvasElement = this.shadowRoot?.querySelector('canvas') || null;\n    this.#outputElement = this.shadowRoot?.getElementById('output') || null;\n    this.#videoElement = this.shadowRoot?.querySelector('video') || null;\n    this.#captureButtonSlot = this.shadowRoot?.querySelector('slot[name=\"capture-button\"]') || null;\n    this.#captureButton = this.#getCaptureButton();\n    this.#facingModeButtonSlot = this.shadowRoot?.querySelector('slot[name=\"facing-mode-button\"]') || null;\n    this.#facingModeButton = this.#getFacingModeButton();\n\n    this.#videoElement?.addEventListener('loadedmetadata', this.#onVideoLoadedMetaData);\n    this.#captureButtonSlot?.addEventListener('slotchange', this.#onCaptureButtonSlotChange);\n    this.#captureButton?.addEventListener('click', this.#onCapturePhotoButtonClick);\n    this.#facingModeButtonSlot?.addEventListener('slotchange', this.#onFacingModeButtonSlotChange);\n    this.#facingModeButton?.addEventListener('click', this.#onFacingModeButtonClick);\n\n    if (!CapturePhoto.isSupported()) {\n      return this.dispatchEvent(new CustomEvent(`${COMPONENT_NAME}:error`, {\n        bubbles: true,\n        composed: true,\n        detail: {\n          error: {\n            name: 'NotSupportedError',\n            message: 'Not supported'\n          }\n        }\n      }));\n    }\n\n    if (this.autoPlay) {\n      this.startVideoStream();\n    }\n  }\n\n  /**\n   * Lifecycle method that is called when the element is removed from the DOM.\n   */\n  disconnectedCallback() {\n    this.stopVideoStream();\n    this.#facingModeButton?.removeEventListener('click', this.#onFacingModeButtonClick);\n    this.#captureButton?.removeEventListener('click', this.#onCapturePhotoButtonClick);\n    this.#videoElement?.removeEventListener('canplay', this.#onVideoLoadedMetaData);\n    this.#captureButtonSlot?.removeEventListener('slotchange', this.#onCaptureButtonSlotChange);\n    this.#facingModeButtonSlot?.removeEventListener('slotchange', this.#onFacingModeButtonSlotChange);\n  }\n\n  /**\n   * @type {boolean} autoPlay - Whether or not to start the video stream automatically.\n   * @attribute auto-play - Reflects the autoPlay attribute.\n   */\n  get autoPlay() {\n    return this.hasAttribute('auto-play');\n  }\n\n  set autoPlay(value) {\n    this.toggleAttribute('auto-play', !!value);\n  }\n\n  /**\n   * @type {boolean} noImage - Whether or not to show the captured image.\n   * @attribute no-image - Reflects the noImage attribute.\n   */\n  get noImage() {\n    return this.hasAttribute('no-image');\n  }\n\n  set noImage(value) {\n    this.toggleAttribute('no-image', !!value);\n  }\n\n  /**\n   * @type {string} facingMode - The facing mode of the camera.\n   * @attribute facing-mode - Reflects the facingMode attribute.\n   */\n  get facingMode() {\n    return this.getAttribute('facing-mode') || 'user';\n  }\n\n  set facingMode(value) {\n    this.setAttribute('facing-mode', value);\n  }\n\n  /**\n   * @type {string} cameraResolution - The resolution of the camera.\n   * @attribute camera-resolution - Reflects the cameraResolution attribute.\n   */\n  get cameraResolution() {\n    return this.getAttribute('camera-resolution') || '';\n  }\n\n  set cameraResolution(value) {\n    this.setAttribute('camera-resolution', value);\n  }\n\n  /**\n   * @type {number} pan - The pan value of the camera.\n   * @attribute pan - Reflects the pan attribute.\n   */\n  get pan() {\n    return Number(this.getAttribute('pan')) || 0;\n  }\n\n  set pan(value) {\n    this.setAttribute('pan', value != null ? value.toString() : value);\n  }\n\n  /**\n   * @type {number} tilt - The tilt value of the camera.\n   * @attribute tilt - Reflects the tilt attribute.\n   */\n  get tilt() {\n    return Number(this.getAttribute('tilt')) || 0;\n  }\n\n  set tilt(value) {\n    this.setAttribute('tilt', value != null ? value.toString() : value);\n  }\n\n  /**\n   * @type {number} zoom - The zoom value of the camera.\n   * @attribute zoom - Reflects the zoom attribute.\n   */\n  get zoom() {\n    return Number(this.getAttribute('zoom')) || 1;\n  }\n\n  set zoom(value) {\n    this.setAttribute('zoom', value != null ? value.toString() : value);\n  }\n\n  /**\n   * @type {boolean} loading - Whether or not the video stream is loading.\n   * @attribute loading - Reflects the loading attribute.\n   */\n  get loading() {\n    return this.hasAttribute('loading');\n  }\n\n  /**\n   * @type {boolean} calculateFileSize - Whether or not to calculate the file size of the captured image.\n   * @attribute calculate-file-size - Reflects the calculateFileSize attribute.\n   */\n  get calculateFileSize() {\n    return this.hasAttribute('calculate-file-size');\n  }\n\n  set calculateFileSize(value) {\n    this.toggleAttribute('calculate-file-size', !!value);\n  }\n\n  /**\n   * Handles the click event of the facing mode button.\n   *\n   * @param {*} evt - The click event.\n   */\n  #onFacingModeButtonClick = evt => {\n    evt.preventDefault();\n\n    if (this.loading) {\n      return;\n    }\n\n    this.facingMode = this.facingMode === 'user' || !this.facingMode ? 'environment' : 'user';\n  };\n\n  /**\n   * Handles the click event of the capture button.\n   *\n   * @param {*} evt - The click event.\n   */\n  #onCapturePhotoButtonClick = evt => {\n    evt.preventDefault();\n    this.capture();\n  };\n\n  /**\n   * Handles the loadedmetadata event of the video element.\n   *\n   * @param {*} evt - The loadedmetadata event.\n   */\n  #onVideoLoadedMetaData = evt => {\n    const video = evt.target;\n\n    video.play().then(() => {\n      this.dispatchEvent(new CustomEvent(`${COMPONENT_NAME}:video-play`, {\n        bubbles: true,\n        composed: true,\n        detail: { video }\n      }));\n    }).catch(/** @param {Error} error */error => {\n      this.dispatchEvent(new CustomEvent(`${COMPONENT_NAME}:error`, {\n        bubbles: true,\n        composed: true,\n        detail: { error }\n      }));\n    }).finally(() => {\n      this.removeAttribute('loading');\n    });\n  };\n\n  /**\n   * Removes all child nodes from the output element.\n   */\n  #emptyOutputElement() {\n    if (!this.#outputElement) {\n      return;\n    }\n\n    Array.from(this.#outputElement.childNodes).forEach(node => node.remove());\n  }\n\n  /**\n   * Applies the pan, tilt or zoom constraint.\n   *\n   * @param {'pan' | 'tilt' | 'zoom'} constraintName - The name of the constraint.\n   * @param {number} constraintValue - The value of the constraint.\n   */\n  #applyPTZ(constraintName, constraintValue) {\n    if (!this.#stream || !constraintName || !constraintValue) {\n      return;\n    }\n\n    const [track] = this.#stream.getVideoTracks();\n    /** @type {ExtendedMediaTrackCapabilities} */\n    const trackCapabilities = this.getTrackCapabilities();\n    const trackSettings = this.getTrackSettings();\n\n    if (constraintName in trackSettings) {\n      track.applyConstraints({\n        advanced: [{\n          [constraintName]: clamp(Number(constraintValue), trackCapabilities[constraintName]?.min || 1, trackCapabilities[constraintName]?.max || 1)\n        }]\n      });\n    }\n  }\n\n  /**\n   * Handles the slotchange event of the capture button slot.\n   *\n   * @param {*} evt - The slotchange event.\n   */\n  #onCaptureButtonSlotChange = evt => {\n    if (evt.target?.name === 'capture-button') {\n      this.#captureButton?.removeEventListener('click', this.#onCapturePhotoButtonClick);\n      this.#captureButton = this.#getCaptureButton();\n\n      if (this.#captureButton) {\n        this.#captureButton.addEventListener('click', this.#onCapturePhotoButtonClick);\n\n        if (this.#captureButton.nodeName !== 'BUTTON' && !this.#captureButton.hasAttribute('role')) {\n          this.#captureButton.setAttribute('role', 'button');\n        }\n      }\n    }\n  };\n\n  /**\n   * Handles the slotchange event of the facing mode button slot.\n   *\n   * @param {*} evt - The slotchange event.\n   */\n  #onFacingModeButtonSlotChange = evt => {\n    if (evt.target?.name === 'facing-mode-button') {\n      this.#facingModeButton?.removeEventListener('click', this.#onFacingModeButtonClick);\n      this.#facingModeButton = this.#getFacingModeButton();\n\n      if (this.#facingModeButton) {\n        this.#facingModeButton.addEventListener('click', this.#onFacingModeButtonClick);\n\n        if (this.#facingModeButton.nodeName !== 'BUTTON' && !this.#facingModeButton.hasAttribute('role')) {\n          this.#facingModeButton.setAttribute('role', 'button');\n        }\n      }\n    }\n  };\n\n  /**\n   * Returns the facing mode button.\n   *\n   * @returns {Nullable<HTMLButtonElement | Element>}\n   */\n  #getFacingModeButton() {\n    if (!this.#facingModeButtonSlot) {\n      return null;\n    }\n\n    return this.#facingModeButtonSlot.assignedElements({ flatten: true }).find(el => {\n      return el.nodeName === 'BUTTON' || el.getAttribute('slot') === 'facing-mode-button';\n    }) || null;\n  }\n\n  /**\n   * Returns the capture button.\n   *\n   * @returns {Nullable<HTMLButtonElement | Element>}\n   */\n  #getCaptureButton() {\n    if (!this.#captureButtonSlot) {\n      return null;\n    }\n\n    return this.#captureButtonSlot.assignedElements({ flatten: true }).find(el => {\n      return el.nodeName === 'BUTTON' || el.getAttribute('slot') === 'capture-button';\n    }) || null;\n  }\n\n  /**\n   * This is to safe guard against cases where, for instance, a framework may have added the element to the page and\n   * set a value on one of its properties, but lazy loaded its definition. Without this guard, the upgraded element would\n   * miss that property and the instance property would prevent the class property setter from ever being called.\n   *\n   * https://developers.google.com/web/fundamentals/web-components/best-practices#lazy-properties\n   *\n   * @param {'autpoPlay' | 'noImage' | 'facingMode' | 'cameraResolution' | 'pan' | 'tilt' | 'zoom' | 'calculateFileSize'} prop\n   */\n  #upgradeProperty(prop) {\n    /** @type {any} */\n    const instance = this;\n\n    if (Object.prototype.hasOwnProperty.call(instance, prop)) {\n      const value = instance[prop];\n      delete instance[prop];\n      instance[prop] = value;\n    }\n  }\n\n  /**\n   * Starts the video stream.\n   *\n   * @returns Promise<void>\n   */\n  async startVideoStream() {\n    if (!CapturePhoto.isSupported() || this.#stream) {\n      return;\n    }\n\n    this.setAttribute('loading', '');\n\n    /** @type {ExtendedMediaTrackConstraints} */\n    const constraints = {\n      video: {\n        facingMode: {\n          ideal: this.facingMode || 'user'\n        },\n        pan: true,\n        tilt: true,\n        zoom: true\n      },\n      audio: false\n    };\n\n    if (typeof this.cameraResolution === 'string' && this.cameraResolution.trim().length > 0) {\n      const [width = 0, height = 0] = this.cameraResolution.split('x').map(x => Number(x));\n\n      if (width > 0 && height > 0) {\n        constraints.video.width = width;\n        constraints.video.height = height;\n      }\n    }\n\n    try {\n      this.#stream = await navigator.mediaDevices.getUserMedia(constraints);\n\n      if (this.#videoElement) {\n        this.#videoElement.srcObject = this.#stream;\n      }\n\n      this.#applyPTZ('pan', this.pan);\n      this.#applyPTZ('tilt', this.tilt);\n      this.#applyPTZ('zoom', this.zoom);\n\n      const trackSettings = this.getTrackSettings();\n\n      if ('facingMode' in trackSettings && this.#facingModeButtonSlot) {\n        this.#facingModeButtonSlot.hidden = false;\n      }\n    } catch (error) {\n      this.dispatchEvent(new CustomEvent(`${COMPONENT_NAME}:error`, {\n        bubbles: true,\n        composed: true,\n        detail: { error }\n      }));\n    } finally {\n      this.removeAttribute('loading');\n    }\n  }\n\n  /**\n   * Stops the video stream.\n   */\n  stopVideoStream() {\n    if (!this.#videoElement || !this.#stream) {\n      return;\n    }\n\n    const [track] = this.#stream.getVideoTracks();\n\n    track?.stop();\n    this.#videoElement.srcObject = null;\n    this.#stream = null;\n  }\n\n  /**\n   * Captures a photo using the element's properties.\n   *\n   * @returns Promise<void>\n   */\n  async capture() {\n    if (this.loading || !this.#canvasElement || !this.#videoElement) {\n      return;\n    }\n\n    try {\n      const ctx = this.#canvasElement.getContext('2d');\n      const width = this.#videoElement.videoWidth;\n      const height = this.#videoElement.videoHeight;\n      this.#canvasElement.width = width;\n      this.#canvasElement.height = height;\n      ctx?.drawImage(this.#videoElement, 0, 0, width, height);\n      const dataURI = this.#canvasElement.toDataURL('image/png');\n\n      if (typeof dataURI === 'string' && dataURI.includes('data:image')) {\n        if (!this.noImage) {\n          const image = new Image();\n          image.src = dataURI;\n          image.width = width;\n          image.height = height;\n          image.setAttribute('part', 'output-image');\n          this.#emptyOutputElement();\n          this.#outputElement?.appendChild(image);\n        }\n\n        /** @type {{ dataURI: string, width: number, height: number, size?: number }} */\n        const eventDetail = { dataURI, width, height };\n\n        if (this.calculateFileSize) {\n          try {\n            const file = await fetch(dataURI);\n            const blob = await file.blob();\n            const size = blob.size;\n\n            if (size) {\n              eventDetail.size = size;\n            }\n          } catch (err) {\n            // Fail silently...\n          }\n        }\n\n        this.dispatchEvent(new CustomEvent(`${COMPONENT_NAME}:success`, {\n          bubbles: true,\n          composed: true,\n          detail: eventDetail\n        }));\n      }\n    } catch (error) {\n      this.dispatchEvent(new CustomEvent(`${COMPONENT_NAME}:error`, {\n        bubbles: true,\n        composed: true,\n        detail: { error }\n      }));\n    }\n  }\n\n  /**\n   * Returns an object based on the `MediaTrackSupportedConstraints` dictionary,\n   * whose member fields each specify one ofthe constrainable properties the user agent understands.\n   *\n   * @see https://developer.mozilla.org/docs/Web/API/MediaDevices/getSupportedConstraints\n   * @returns {MediaTrackSupportedConstraints | {}}\n   */\n  getSupportedConstraints() {\n    if (!CapturePhoto.isSupported()) {\n      return {};\n    }\n\n    return navigator.mediaDevices.getSupportedConstraints() || {};\n  }\n\n  /**\n   * Returns a `MediaTrackCapabilities` object which specifies the values or range of values\n   * which each constrainable property, based upon the platform and user agent.\n   *\n   * @see https://developer.mozilla.org/docs/Web/API/MediaStreamTrack/getCapabilities\n   * @returns {MediaTrackCapabilities | {}}\n   */\n  getTrackCapabilities() {\n    if (!this.#stream) {\n      return {};\n    }\n\n    const [track] = this.#stream.getVideoTracks();\n\n    if (track && typeof track.getCapabilities === 'function') {\n      return track.getCapabilities() || {};\n    }\n\n    return {};\n  }\n\n  /**\n   * Returns a `MediaTrackSettings` object containing the current values of each of\n   * the constrainable properties for the current MediaStreamTrack.\n   *\n   * @see https://developer.mozilla.org/docs/Web/API/MediaStreamTrack/getSettings\n   * @returns {MediaTrackSettings | {}}\n   */\n  getTrackSettings() {\n    if (!this.#stream) {\n      return {};\n    }\n\n    const [track] = this.#stream.getVideoTracks();\n\n    if (track && typeof track.getSettings === 'function') {\n      return track.getSettings() || {};\n    }\n\n    return {};\n  }\n\n  /**\n   * Checks if the `MediaDevices.getUserMedia()` method is supported.\n   *\n   * @returns {boolean}\n   */\n  static isSupported() {\n    return Boolean(navigator.mediaDevices?.getUserMedia);\n  }\n\n  /**\n   * Defines a custom element with the given name.\n   * The name must contain a dash (-).\n   *\n   * @param {string} [elementName='capture-photo'] - The name of the custom element.\n   * @example\n   *\n   * CapturePhoto.defineCustomElement('my-capture-photo');\n   */\n  static defineCustomElement(elementName = COMPONENT_NAME) {\n    if (typeof window !== 'undefined' && !window.customElements.get(elementName)) {\n      window.customElements.define(elementName, CapturePhoto);\n    }\n  }\n}\n\nexport { CapturePhoto };\n","// @ts-check\n\n/**\n * Clamps number within the inclusive `min` and `max` bounds,\n * making sure it does not go beyond them on either side.\n * If `min` is greater than `max` the parameters are swapped to support inverted ranges.\n *\n * @param {number} value - The number to clamp.\n * @param {number} lower - The lower bound.\n * @param {number} upper - The upper bound.\n * @throws {TypeError} - If one or more of the arguments passed is not a number.\n * @returns {number} - The clamped number.\n * @example\n *\n * clamp(10, -5, 5);\n * // => 5\n *\n * clamp(-10, -5, 5);\n * // => -5\n *\n * clamp(-15, 0, 100);\n * // => 0\n *\n * clamp(120, 0, 100);\n * // => 100\n *\n * clamp(-5, NaN, 5); // If any of lower or upper bound are `NaN`, they will be converted to `0`.\n * // => 0\n *\n * clamp(120, 100, 0); // The order of lower and upper bounds is reversed (100 > 0)\n * // => 100\n */\nexport const clamp = (value, lower, upper) => {\n  if (Number.isNaN(lower)) {\n    lower = 0;\n  }\n\n  if (Number.isNaN(upper)) {\n    upper = 0;\n  }\n\n  return Math.min(Math.max(value, Math.min(lower, upper)), Math.max(lower, upper));\n};\n","import { set, get } from 'idb-keyval';\r\n\r\nconst STORAGE_PREFIX = 'barcode-scanner/';\r\nconst SETTINGS_STORAGE_KEY = 'settings';\r\nconst HISTORY_STORAGE_KEY = 'history';\r\n\r\nconst getItem = async key => {\r\n  try {\r\n    return {\r\n      value: await get(key),\r\n      error: void 0\r\n    };\r\n  } catch (error) {\r\n    return {\r\n      value: void 0,\r\n      error\r\n    };\r\n  }\r\n};\r\n\r\nconst setItem = async (key, data) => {\r\n  try {\r\n    await set(key, data);\r\n\r\n    return {\r\n      error: void 0\r\n    };\r\n  } catch (error) {\r\n    return { error };\r\n  }\r\n};\r\n\r\nexport const getSettings = async () => {\r\n  return getItem(STORAGE_PREFIX + SETTINGS_STORAGE_KEY);\r\n};\r\n\r\nexport const setSettings = async data => {\r\n  return setItem(STORAGE_PREFIX + SETTINGS_STORAGE_KEY, data);\r\n};\r\n\r\nexport const getHistory = async () => {\r\n  return getItem(STORAGE_PREFIX + HISTORY_STORAGE_KEY);\r\n};\r\n\r\nexport const setHistory = async data => {\r\n  return setItem(STORAGE_PREFIX + HISTORY_STORAGE_KEY, data);\r\n};\r\n","function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction promisifyRequest(request) {\n  return new Promise(function (resolve, reject) {\n    // @ts-ignore - file size hacks\n    request.oncomplete = request.onsuccess = function () {\n      return resolve(request.result);\n    }; // @ts-ignore - file size hacks\n\n\n    request.onabort = request.onerror = function () {\n      return reject(request.error);\n    };\n  });\n}\n\nfunction createStore(dbName, storeName) {\n  var request = indexedDB.open(dbName);\n\n  request.onupgradeneeded = function () {\n    return request.result.createObjectStore(storeName);\n  };\n\n  var dbp = promisifyRequest(request);\n  return function (txMode, callback) {\n    return dbp.then(function (db) {\n      return callback(db.transaction(storeName, txMode).objectStore(storeName));\n    });\n  };\n}\n\nvar defaultGetStoreFunc;\n\nfunction defaultGetStore() {\n  if (!defaultGetStoreFunc) {\n    defaultGetStoreFunc = createStore('keyval-store', 'keyval');\n  }\n\n  return defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction get(key) {\n  var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultGetStore();\n  return customStore('readonly', function (store) {\n    return promisifyRequest(store.get(key));\n  });\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction set(key, value) {\n  var customStore = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultGetStore();\n  return customStore('readwrite', function (store) {\n    store.put(value, key);\n    return promisifyRequest(store.transaction);\n  });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic  if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction setMany(entries) {\n  var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultGetStore();\n  return customStore('readwrite', function (store) {\n    entries.forEach(function (entry) {\n      return store.put(entry[1], entry[0]);\n    });\n    return promisifyRequest(store.transaction);\n  });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction getMany(keys) {\n  var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultGetStore();\n  return customStore('readonly', function (store) {\n    return Promise.all(keys.map(function (key) {\n      return promisifyRequest(store.get(key));\n    }));\n  });\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction update(key, updater) {\n  var customStore = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultGetStore();\n  return customStore('readwrite', function (store) {\n    return (// Need to create the promise manually.\n      // If I try to chain promises, the transaction closes in browsers\n      // that use a promise polyfill (IE10/11).\n      new Promise(function (resolve, reject) {\n        store.get(key).onsuccess = function () {\n          try {\n            store.put(updater(this.result), key);\n            resolve(promisifyRequest(store.transaction));\n          } catch (err) {\n            reject(err);\n          }\n        };\n      })\n    );\n  });\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction del(key) {\n  var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultGetStore();\n  return customStore('readwrite', function (store) {\n    store.delete(key);\n    return promisifyRequest(store.transaction);\n  });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction delMany(keys) {\n  var customStore = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultGetStore();\n  return customStore('readwrite', function (store) {\n    keys.forEach(function (key) {\n      return store.delete(key);\n    });\n    return promisifyRequest(store.transaction);\n  });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction clear() {\n  var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultGetStore();\n  return customStore('readwrite', function (store) {\n    store.clear();\n    return promisifyRequest(store.transaction);\n  });\n}\n\nfunction eachCursor(store, callback) {\n  store.openCursor().onsuccess = function () {\n    if (!this.result) return;\n    callback(this.result);\n    this.result.continue();\n  };\n\n  return promisifyRequest(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction keys() {\n  var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultGetStore();\n  return customStore('readonly', function (store) {\n    // Fast path for modern browsers\n    if (store.getAllKeys) {\n      return promisifyRequest(store.getAllKeys());\n    }\n\n    var items = [];\n    return eachCursor(store, function (cursor) {\n      return items.push(cursor.key);\n    }).then(function () {\n      return items;\n    });\n  });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction values() {\n  var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultGetStore();\n  return customStore('readonly', function (store) {\n    // Fast path for modern browsers\n    if (store.getAll) {\n      return promisifyRequest(store.getAll());\n    }\n\n    var items = [];\n    return eachCursor(store, function (cursor) {\n      return items.push(cursor.value);\n    }).then(function () {\n      return items;\n    });\n  });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\n\n\nfunction entries() {\n  var customStore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultGetStore();\n  return customStore('readonly', function (store) {\n    // Fast path for modern browsers\n    // (although, hopefully we'll get a simpler path some day)\n    if (store.getAll && store.getAllKeys) {\n      return Promise.all([promisifyRequest(store.getAllKeys()), promisifyRequest(store.getAll())]).then(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            keys = _ref2[0],\n            values = _ref2[1];\n\n        return keys.map(function (key, i) {\n          return [key, values[i]];\n        });\n      });\n    }\n\n    var items = [];\n    return customStore('readonly', function (store) {\n      return eachCursor(store, function (cursor) {\n        return items.push([cursor.key, cursor.value]);\n      }).then(function () {\n        return items;\n      });\n    });\n  });\n}\n\nexport { clear, createStore, del, delMany, entries, get, getMany, keys, promisifyRequest, set, setMany, update, values };\n","// src/js/services/product-service.js\r\nimport { \r\n  doc, \r\n  getDoc, \r\n  setDoc, \r\n  updateDoc,\r\n  collection,\r\n  getDocs,\r\n  serverTimestamp \r\n} from 'firebase/firestore';\r\nimport { db } from './firebase-config.js';\r\n\r\n// Get product by barcode from global catalog\r\nexport const getProductByBarcode = async (barcode) => {\r\n  const productDoc = await getDoc(doc(db, 'products', barcode));\r\n  if (productDoc.exists()) {\r\n    return { id: productDoc.id, ...productDoc.data() };\r\n  }\r\n  return null;\r\n};\r\n\r\n// Create new product in global catalog\r\nexport const createProduct = async (barcode, productData) => {\r\n  // Handle both string (name only) and object formats\r\n  const name = typeof productData === 'string' ? productData : productData?.name;\r\n  const description = typeof productData === 'object' ? (productData?.description || '') : '';\r\n  const imageUrl = typeof productData === 'object' ? (productData?.imageUrl || null) : null;\r\n  const category = typeof productData === 'object' ? (productData?.category || 'uncategorized') : 'uncategorized';\r\n  \r\n  const product = {\r\n    barcode,\r\n    name,\r\n    description,\r\n    imageUrl,\r\n    category,\r\n    createdAt: serverTimestamp(),\r\n    updatedAt: serverTimestamp()\r\n  };\r\n  \r\n  await setDoc(doc(db, 'products', barcode), product);\r\n  return product;\r\n};\r\n\r\n// Update product in global catalog\r\nexport const updateProduct = async (barcode, updates) => {\r\n  const productRef = doc(db, 'products', barcode);\r\n  await updateDoc(productRef, {\r\n    ...updates,\r\n    updatedAt: serverTimestamp()\r\n  });\r\n};\r\n\r\n// Search products by name (basic client-side search)\r\nexport const searchProducts = async (searchTerm) => {\r\n  const productsRef = collection(db, 'products');\r\n  const snapshot = await getDocs(productsRef);\r\n  \r\n  const products = [];\r\n  const searchLower = searchTerm.toLowerCase();\r\n  \r\n  snapshot.forEach((doc) => {\r\n    const data = doc.data();\r\n    if (data.name && data.name.toLowerCase().includes(searchLower)) {\r\n      products.push({ id: doc.id, ...data });\r\n    }\r\n  });\r\n  \r\n  return products;\r\n};\r\n\r\n// Get or create product - returns existing or creates new\r\nexport const getOrCreateProduct = async (barcode, productData) => {\r\n  let product = await getProductByBarcode(barcode);\r\n  \r\n  if (!product && productData) {\r\n    product = await createProduct(barcode, productData);\r\n  }\r\n  \r\n  return product;\r\n};\r\n"],"names":["$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","$81b28a4cd686838b$var$s","$e92a13782f6c06ba$var$defaultGetStoreFunc","$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","parcelRegister","$81b28a4cd686838b$var$n","t","i","has","TypeError","$81b28a4cd686838b$var$o","value","$81b28a4cd686838b$var$r","$81b28a4cd686838b$var$l","$81b28a4cd686838b$var$d","$81b28a4cd686838b$var$h","writable","$81b28a4cd686838b$var$c","$81b28a4cd686838b$var$u","add","$0380ce8f1f064ccc$export$6503ec6e8aabbaf","$0380ce8f1f064ccc$export$f7ad0328861e2f03","$0380ce8f1f064ccc$var$mapping","Map","baseUrl","manifest","length","path","resolved","URL","toString","$7dd1ddf6834435ca$export$bdfd709ae4826697","$7dd1ddf6834435ca$var$bundleURL","$7dd1ddf6834435ca$var$getBundleURL","matches","stack","match","replace","resolve","then","$2prpb","bundle","Promise","reject","concat","document","getElementsByTagName","some","script","src","preloadLink","createElement","href","rel","as","head","appendChild","async","type","onerror","error","message","onload","remove","$1c132cac09cd18d9$var$cachedBundles","$1c132cac09cd18d9$var$cachedPreloads","$1c132cac09cd18d9$var$cachedPrefetches","loader","cache","$1c132cac09cd18d9$var$getCache","apply","arguments","catch","getBundleURL","JSON","parse","$81b28a4cd686838b$export$f0e45424cc896229","$81b28a4cd686838b$var$b","$81b28a4cd686838b$var$w","String","raw","innerHTML","$81b28a4cd686838b$var$f","WeakMap","$81b28a4cd686838b$var$p","$81b28a4cd686838b$var$v","$81b28a4cd686838b$var$m","WeakSet","$81b28a4cd686838b$var$E","$81b28a4cd686838b$var$g","$81b28a4cd686838b$var$y","HTMLElement","observedAttributes","attributeChangedCallback","disabled","$81b28a4cd686838b$var$z","$81b28a4cd686838b$var$C","connectedCallback","$81b28a4cd686838b$var$O","ResizeObserver","dispatchEvent","CustomEvent","bubbles","composed","detail","entries","addEventListener","disconnectedCallback","removeEventListener","hasAttribute","setAttribute","removeAttribute","defineCustomElement","customElements","define","constructor","shadowRoot","attachShadow","mode","content","cloneNode","querySelector","forEach","unobserve","assignedElements","observe","push","disconnect","prototype","hasOwnProperty","$636b0cf1ed0b9f88$export$cc30a98fe3890794","$636b0cf1ed0b9f88$var$t","Number","isNaN","Math","min","max","$636b0cf1ed0b9f88$var$e","$636b0cf1ed0b9f88$var$i","$636b0cf1ed0b9f88$var$o","o","a","r","l","getSupportedConstraints","isConnected","getTrackCapabilities","getTrackSettings","u","includes","facingMode","stopVideoStream","startVideoStream","cameraResolution","trim","split","map","width","height","pan","h","tilt","zoom","d","getElementById","c","m","p","g","b","f","isSupported","name","autoPlay","toggleAttribute","noImage","getAttribute","loading","calculateFileSize","preventDefault","capture","target","play","video","finally","Array","from","childNodes","getVideoTracks","applyConstraints","advanced","nodeName","flatten","find","ideal","audio","navigator","mediaDevices","getUserMedia","srcObject","hidden","stop","getContext","videoWidth","videoHeight","drawImage","toDataURL","Image","dataURI","fetch","blob","size","getCapabilities","getSettings","$e92a13782f6c06ba$export$b327150396135fe7","request","oncomplete","onsuccess","result","onabort","$e92a13782f6c06ba$var$defaultGetStore","storeName","dbp","indexedDB","open","onupgradeneeded","createObjectStore","txMode","callback","db","transaction","objectStore","$c96efe8837e99c11$var$STORAGE_PREFIX","$c96efe8837e99c11$var$SETTINGS_STORAGE_KEY","$c96efe8837e99c11$var$getItem","key","customStore","undefined","store","$c96efe8837e99c11$var$setItem","data","put","$c96efe8837e99c11$export$4a647155031ece","$c96efe8837e99c11$export$dc86d17a64679bc7","$5Gd8p","$kkiei","$6m2hf","$6d70e5dcf1eba205$export$99c80bd423f4415","barcode","productDoc","getDoc","doc","exists","$6d70e5dcf1eba205$export$9c734a715e6666d0","productData","product","description","imageUrl","category","createdAt","serverTimestamp","updatedAt","setDoc","$6d70e5dcf1eba205$export$8d590d0c8872145e","updates","productRef","updateDoc","$29ebe6aa764dae38$var$showToast","container","toast","className","textContent","setTimeout","rafId","getCurrentFridgeCode","location","capturePhotoEl","scanInstructionsEl","rescanBtn","scanFrameEl","settingsBtn","settingsDialog","settingsForm","forms","productDialog","productForm","productBarcodeInput","productNameInput","productQuantityInput","shouldRepeatScan","isScanning","capturePhotoVideoEl","initializeFirebase","console","log","formats","BarcodeDetector","getSupportedFormats","barcodeDetector","settings","beep","vibrate","input","checked","getVideoElement","audioCtx","getAudioContext","AudioContext","webkitAudioContext","state","resume","duration","frequency","volume","ctx","oscillator","createOscillator","gainNode","createGain","connect","destination","gain","start","currentTime","startScanning","scan","videoEl","readyState","requestAnimationFrame","detect","results","isArray","rawValue","cancelAnimationFrame","handleBarcodeDetected","showProductDialog","existingName","showModal","focus","select","handleAddProduct","quantity","parseInt","existingProduct","addToFridge","close","evt","resizeScanFrame","rect","getBoundingClientRect","style","cssText","trackSettings","trackCapabilities","zoomLevelEl","zoomControls","minZoom","maxZoom","currentZoom","toFixed","action","closest","dataset","currentTarget","querySelectorAll","cb","$54e5dea46d3d830b$export$2e2bcd8739ae039","receiver","privateMap","$4a9af28d8c332738$export$2e2bcd8739ae039","descriptor","$0ebd1ade8fb3d51f$export$2e2bcd8739ae039","$ce94785d052866a0$export$2e2bcd8739ae039","obj","privateCollection","$96b9e3133fa8e43f$export$2e2bcd8739ae039","$a5f62c39645bb2ba$export$2e2bcd8739ae039","$6108fbe778b62371$export$2e2bcd8739ae039","$1b12450ac511053e$export$2e2bcd8739ae039","privateSet","fn","$39719070878026a5$export$2e2bcd8739ae039","$3a4003478dee0771$var$template","$3a4003478dee0771$var$html","$3a4003478dee0771$var$_slotEl","$3a4003478dee0771$var$_resizeObserver","$3a4003478dee0771$var$_observedElements","$3a4003478dee0771$var$_startObserver","$3a4003478dee0771$var$_stopObserver","$3a4003478dee0771$var$_onSlotChange","$3a4003478dee0771$var$_upgradeProperty","$3a4003478dee0771$export$f0e45424cc896229","oldValue","newValue","this","$3a4003478dee0771$var$stopObserver","$3a4003478dee0771$var$startObserver","$3a4003478dee0771$var$upgradeProperty","static","elementName","super","el","prop","$c290816263f90981$export$cc30a98fe3890794","$02ad8beec419df62$export$7d15b64cf5a3a4c4","lower","upper","$c290816263f90981$var$COMPONENT_NAME","$c290816263f90981$var$styles","$c290816263f90981$var$template","supportedConstraints","stream","canvasElement","outputElement","videoElement","captureButtonSlot","captureButton","facingModeButtonSlot","facingModeButton","emptyOutputElement","isValidFacingMode","x","widthInAllowedRange","heightInAllowedRange","panInAllowedRange","applyPTZ","tiltInAllowedRange","zoomInAllowedRange","upgradeProperty","getCaptureButton","getFacingModeButton","onVideoLoadedMetaData","onCaptureButtonSlotChange","onCapturePhotoButtonClick","onFacingModeButtonSlotChange","onFacingModeButtonClick","node","constraintName","constraintValue","track","instance","constraints","image","eventDetail","file","Boolean","CapturePhoto"],"version":3,"file":"scanner.b2c49530.js.map"}